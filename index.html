<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® ××•×›× ×™× ×œ×›×™×ª×” ×'!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            height: 100vh;
            padding: 20px;
            overflow: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        h1 {
            text-align: center;
            color: #667eea;
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.3em;
            margin-bottom: 40px;
        }

        .user-stats {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            font-size: 1.2em;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .games-grid.hidden {
            display: none;
        }

        .sub-game-mode {
            display: none;
        }

        .sub-game-mode.active {
            display: block;
        }

        .game-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            color: white;
        }

        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .game-card.pink {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .game-card.blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .game-card.orange {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .game-card.green {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
        }

        .game-card.yellow {
            background: linear-gradient(135deg, #fdeb71 0%, #f8d800 100%);
        }

        .game-card.purple {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .game-icon {
            font-size: 4em;
            margin-bottom: 15px;
        }

        .game-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .game-description {
            font-size: 1em;
            opacity: 0.9;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .back-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.2em;
            cursor: pointer;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        /* Coloring Page Styles */
        .coloring-container {
            text-align: center;
        }

        .canvas-wrapper {
            background: white;
            border-radius: 15px;
            padding: 10px;
            display: inline-block;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 100%;
        }

        #coloringCanvas {
            border: 2px solid #667eea;
            border-radius: 8px;
            cursor: crosshair;
            max-width: 100%;
            height: auto;
        }

        .color-palette {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        .color-option {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
        }

        .color-option:hover {
            transform: scale(1.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .color-option.selected {
            border-color: #333;
            transform: scale(1.2);
        }

        .brush-sizes {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }

        .brush-size {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: #667eea;
            border: 2px solid #333;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .brush-size:hover {
            transform: scale(1.1);
        }

        .brush-size.selected {
            background: #f5576c;
            transform: scale(1.15);
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }

        .action-button {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .action-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        /* Numbers Game Styles */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            max-width: 900px;
            margin: 15px auto;
        }

        .number-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .number-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .number-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .number-word {
            font-size: 0.9em;
            color: #666;
        }

        .number-objects {
            font-size: 1.2em;
            margin-top: 5px;
        }

        /* Memory Game Styles */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            max-width: 500px;
            margin: 15px auto;
        }

        .memory-card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .memory-card:hover {
            transform: scale(1.05);
        }

        .memory-card.flipped {
            background: white;
        }

        .memory-card.matched {
            background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
            cursor: default;
        }

        .memory-card .card-content {
            display: none;
        }

        .memory-card.flipped .card-content,
        .memory-card.matched .card-content {
            display: block;
        }

        .memory-stats {
            text-align: center;
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #667eea;
        }

        /* Letters Game Styles */
        .letters-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            max-width: 900px;
            margin: 10px auto;
        }

        .letter-card {
            background: linear-gradient(135deg, #fdeb71 0%, #f8d800 100%);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .letter-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .letter-value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .letter-name {
            font-size: 0.75em;
            color: #666;
            margin-top: 3px;
        }

        /* Shapes Game Styles */
        .shapes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px auto;
            max-width: 800px;
        }

        .shape-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .shape-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .shape-icon {
            font-size: 5em;
            margin-bottom: 15px;
        }

        .shape-name {
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
        }

        /* Matching Game Styles */
        .matching-container {
            max-width: 800px;
            margin: 30px auto;
        }

        .matching-items {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .matching-item {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
        }

        .matching-item:hover {
            transform: scale(1.05);
        }

        .matching-item.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .matching-item.correct {
            border-color: #30cfd0;
            background: #e6fff9;
        }

        .item-icon {
            font-size: 4em;
            margin-bottom: 10px;
        }

        .item-label {
            font-size: 1.3em;
            color: #333;
        }

        .answer-options {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .answer-option {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
            padding: 20px 40px;
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            color: #333;
        }

        .answer-option:hover {
            transform: scale(1.1);
        }

        .game-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .game-header h2 {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .game-header p {
            color: #666;
            font-size: 1em;
        }

        /* Draggable Items */
        .draggable-item {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 12px;
            padding: 12px 20px;
            font-size: 2em;
            font-weight: bold;
            cursor: grab;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            user-select: none;
            touch-action: none;
        }

        .draggable-item:active {
            cursor: grabbing;
            transform: scale(1.1);
        }

        .draggable-item.dragging {
            opacity: 0.5;
        }

        .drop-zone {
            transition: all 0.3s ease;
        }

        .drop-zone.drag-over {
            background: #e3f2fd !important;
            border-color: #2196F3 !important;
            transform: scale(1.05);
        }

        .drop-zone.correct {
            background: #4CAF50 !important;
            border-color: #4CAF50 !important;
            animation: successPulse 0.6s ease;
        }

        .drop-zone.incorrect {
            background: #f44336 !important;
            border-color: #f44336 !important;
            animation: shake 0.5s ease;
        }

        @keyframes successPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .success-message {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.5em;
            text-align: center;
            margin: 20px auto;
            max-width: 400px;
            animation: fadeInOut 2s ease;
        }

        .error-message {
            background: #f44336;
            color: white;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.5em;
            text-align: center;
            margin: 20px auto;
            max-width: 400px;
            animation: fadeInOut 2s ease;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(-20px); }
            10%, 90% { opacity: 1; transform: translateY(0); }
        }

        /* Settings Button */
        .settings-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.8em;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .settings-button:hover {
            transform: scale(1.1) rotate(90deg);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .settings-modal.active {
            display: flex;
        }

        .settings-content {
            background: white;
            border-radius: 30px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .settings-content h2 {
            color: #667eea;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .setting-label {
            font-size: 1.3em;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            width: 70px;
            height: 35px;
            background: #ccc;
            border-radius: 35px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: #4CAF50;
        }

        .toggle-slider {
            position: absolute;
            width: 27px;
            height: 27px;
            background: white;
            border-radius: 50%;
            top: 4px;
            left: 4px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-slider {
            left: 39px;
        }

        .close-settings {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 15px;
            font-size: 1.3em;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .close-settings:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        /* Sequence Game Styles */
        .sequence-box {
            min-width: 80px;
            min-height: 80px;
            background: white;
            border: 3px solid #667eea;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .sequence-box.empty {
            background: #f0f4ff;
            border-style: dashed;
            border-width: 3px;
            transition: all 0.3s ease;
        }

        .sequence-box.empty.drag-over {
            background: #e3f2fd;
            border-color: #2196F3;
            transform: scale(1.05);
        }

        .sequence-option {
            min-width: 70px;
            min-height: 70px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            color: #333;
        }

        .sequence-option:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .sequence-option.correct-answer {
            background: #4CAF50;
            color: white;
            animation: successPulse 0.6s ease;
        }

        .sequence-option.wrong-answer {
            background: #f44336;
            color: white;
            animation: shake 0.5s ease;
        }

        @media (max-width: 768px) {
            body {
                padding: 0;
                overflow: hidden;
            }

            .container {
                padding: 10px;
                border-radius: 0;
                height: 100vh;
                max-height: 100vh;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                max-width: 100%;
                margin: 0;
            }

            .page.active {
                display: flex;
                flex-direction: column;
                height: 100%;
                overflow: hidden;
            }

            /* Homepage - fill entire screen with equal sized cards */
            #homepage .games-grid {
                flex: 1;
                display: grid !important;
                grid-template-columns: 1fr !important;
                grid-auto-rows: 1fr;
                gap: 12px;
                margin-bottom: 0;
                align-content: stretch;
                overflow-y: auto;
            }

            /* Other pages - scrollable grid */
            .games-grid {
                flex: 1;
                overflow-y: auto;
                align-content: start;
                grid-template-columns: 1fr !important;
                gap: 12px;
                margin-bottom: 0;
            }

            /* Numbers and Letters page grids - 2 columns, fill screen */
            #numbers .games-grid:not(.hidden),
            #letters .games-grid:not(.hidden) {
                display: grid !important;
                grid-template-columns: repeat(2, 1fr) !important;
                grid-template-rows: repeat(2, 1fr);
                height: calc(100vh - 180px);
                gap: 12px;
                overflow: visible;
                align-content: stretch;
            }

            /* Center all text in game cards */
            .game-card {
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                text-align: center;
            }

            /* Game pages - no scroll, everything fits */
            .sub-game-mode.active {
                display: block;
                height: calc(100vh - 120px); /* Full height minus header and back button */
                overflow: hidden;
            }

            /* Make game pages use flexbox layout */
            .page.active > .container {
                display: flex;
                flex-direction: column;
                height: 100%;
            }

            /* Numbers, Letters, Memory modes should fill available space */
            #numberLearnMode,
            #letterLearnMode {
                height: calc(100vh - 160px);
            }

            /* Coloring and matching use flex column */
            .coloring-container,
            .matching-container {
                flex: 1;
                display: flex;
                flex-direction: column;
                overflow: hidden;
                align-items: center;
                justify-content: flex-start;
            }

            /* Headers - larger */
            h1 {
                font-size: 1.8em;
                margin-bottom: 8px;
            }

            .subtitle {
                font-size: 1em;
                margin-bottom: 8px;
            }

            .user-stats {
                display: none; /* Hide on mobile to save space */
            }

            .game-header {
                margin-bottom: 12px;
                flex-shrink: 0;
            }

            .game-header h2 {
                font-size: 1.6em;
                margin-bottom: 5px;
            }

            .game-header h3 {
                font-size: 1.3em;
            }

            .game-header p {
                font-size: 1em;
            }

            .back-button {
                padding: 10px 20px;
                font-size: 1em;
                margin-bottom: 10px;
                flex-shrink: 0;
            }

            /* Game cards on homepage - larger */
            .game-card {
                padding: 20px;
            }

            .game-icon {
                font-size: 2.5em;
                margin-bottom: 8px;
            }

            .game-title {
                font-size: 1.3em;
                margin-bottom: 5px;
            }

            .game-description {
                font-size: 0.95em;
            }

            /* NUMBERS GRID - fill entire screen like homepage */
            .numbers-grid {
                display: grid !important;
                grid-template-columns: repeat(5, 1fr);
                grid-template-rows: repeat(2, 1fr);
                gap: 10px;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            .number-card {
                padding: 8px 4px;
                min-height: 0;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: space-evenly;
                align-items: center;
                overflow: hidden;
            }

            .number-value {
                font-size: 2.5em;
                margin-bottom: 3px;
                line-height: 1;
                height: 1em;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
            }

            .number-word {
                font-size: 1.1em;
                line-height: 1.2;
                height: 1.3em;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-shrink: 0;
            }

            .number-objects {
                font-size: 1em;
                margin-top: 3px;
                line-height: 1;
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
                gap: 2px;
            }

            /* LETTERS GRID - fill entire screen like homepage */
            .letters-grid {
                display: grid !important;
                grid-template-columns: repeat(6, 1fr);
                grid-template-rows: repeat(4, 1fr);
                gap: 8px;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            .letter-card {
                padding: 0;
                min-height: 0;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }

            .letter-value {
                font-size: 2.2em;
            }

            .letter-name {
                font-size: 0.85em;
                margin-top: 5px;
            }

            /* MEMORY GRID - fill entire screen like homepage */
            .memory-grid {
                display: grid !important;
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(4, 1fr);
                gap: 10px;
                width: 100%;
                height: calc(100% - 50px); /* Minus stats height */
                margin: 0;
                padding: 0;
            }

            .memory-card {
                font-size: 2.8em;
                min-height: 0;
            }

            .memory-stats {
                font-size: 1.1em;
                margin-bottom: 8px;
                flex-shrink: 0;
            }

            /* COLORING PAGE - fit everything visible */
            .coloring-container {
                display: flex;
                flex-direction: column;
                align-items: center;
                height: 100%;
                padding-bottom: 10px;
            }

            .canvas-wrapper {
                padding: 5px;
                flex-shrink: 1;
                max-width: 100%;
                max-height: 50vh;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            #coloringCanvas {
                width: 100% !important;
                height: auto !important;
                max-width: 100%;
                max-height: 45vh;
                object-fit: contain;
            }

            .color-palette {
                gap: 5px;
                margin: 5px 0;
                flex-shrink: 0;
            }

            .color-option {
                width: 35px;
                height: 35px;
            }

            .brush-sizes {
                gap: 6px;
                margin: 6px 0;
                flex-shrink: 0;
            }

            .brush-size {
                width: 35px;
                height: 35px;
                font-size: 0.75em;
            }

            .action-buttons {
                gap: 6px;
                margin-top: 6px;
                flex-shrink: 0;
            }

            .action-button {
                padding: 8px 14px;
                font-size: 0.9em;
            }

            /* SHAPES GRID - fill entire screen like homepage */
            .shapes-grid {
                display: grid !important;
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: repeat(3, 1fr);
                gap: 12px;
                width: 100%;
                height: calc(100vh - 140px);
                margin: 0;
                padding: 0;
            }

            .shape-card {
                padding: 0;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }

            .shape-icon {
                font-size: 5em;
                margin-bottom: 12px;
            }

            .shape-name {
                font-size: 1.6em;
            }

            /* MATCHING GAME */
            .matching-container {
                display: flex !important;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            .matching-items {
                flex-direction: row;
                gap: 15px;
                margin-bottom: 20px;
                flex-shrink: 0;
            }

            .matching-item {
                padding: 18px;
            }

            .item-icon {
                font-size: 3.5em;
                margin-bottom: 8px;
            }

            .item-label {
                font-size: 1.2em;
            }

            .answer-options {
                gap: 15px;
                flex-shrink: 0;
            }

            .answer-option {
                padding: 15px 30px;
                font-size: 1.8em;
            }

            /* DRAG AND DROP GAMES */
            #dragNumberOptions,
            #dragLetterOptions,
            #sequenceOptions {
                display: flex !important;
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
                margin-top: 10px;
                flex-shrink: 0;
            }

            .draggable-item {
                font-size: 2em;
                padding: 12px 20px;
                min-width: 60px;
            }

            #countObjectsDisplay {
                font-size: 2.5em !important;
                margin: 10px 0 !important;
                min-height: 60px !important;
                flex-shrink: 0;
            }

            #dragNumberTarget,
            #dragLetterTarget {
                min-height: 100px !important;
                font-size: 3em !important;
                margin: 10px auto !important;
                max-width: 320px !important;
                border-width: 3px !important;
                flex-shrink: 0;
            }

            #sequenceDisplay {
                margin: 12px 0 !important;
                gap: 12px !important;
                flex-shrink: 0;
                display: flex;
                justify-content: center;
                flex-wrap: wrap;
            }

            .sequence-box {
                min-width: 70px;
                min-height: 70px;
                font-size: 2.5em;
            }

            .sequence-option {
                min-width: 65px;
                min-height: 65px;
                font-size: 2.2em;
            }

            /* WRITING CANVASES - fit with buttons visible */
            #letterWriteCanvas, #numberWriteCanvas {
                width: 100% !important;
                height: auto !important;
                max-width: 350px;
                max-height: 40vh;
                aspect-ratio: 1;
            }

            /* SETTINGS */
            .settings-button {
                width: 45px;
                height: 45px;
                font-size: 1.3em;
                top: 8px;
                left: 8px;
            }

            .settings-content {
                padding: 25px 15px;
            }

            .settings-content h2 {
                font-size: 1.6em;
                margin-bottom: 20px;
            }

            .setting-item {
                padding: 15px;
                margin-bottom: 12px;
            }

            .setting-label {
                font-size: 1em;
            }

            .toggle-switch {
                width: 60px;
                height: 30px;
            }

            .toggle-slider {
                width: 24px;
                height: 24px;
                top: 3px;
                left: 3px;
            }

            .toggle-switch.active .toggle-slider {
                left: 33px;
            }

            .close-settings {
                padding: 12px 30px;
                font-size: 1.1em;
            }
        }

        /* Printables Styles */
        .printable-sheet {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                max-width: 100%;
                padding: 20px;
                box-shadow: none;
            }

            .back-button,
            .action-button,
            .settings-button,
            #sheetIndicator {
                display: none !important;
            }

            .printable-sheet {
                page-break-after: always;
            }
        }
    </style>
</head>
<body>
    <!-- Settings Button -->
    <button class="settings-button" onclick="openSettings()">âš™ï¸</button>

    <!-- Settings Modal -->
    <div id="settingsModal" class="settings-modal" onclick="closeSettingsOnBackdrop(event)">
        <div class="settings-content">
            <h2>âš™ï¸ ×”×’×“×¨×•×ª</h2>

            <div class="setting-item">
                <div class="setting-label">
                    <span>ğŸ”Š</span>
                    <span>×”×©××¢×ª ×©××¢</span>
                </div>
                <div class="toggle-switch active" id="soundToggle" onclick="toggleSound()">
                    <div class="toggle-slider"></div>
                </div>
            </div>

            <div class="setting-item">
                <div class="setting-label">
                    <span>ğŸµ</span>
                    <span>××•×–×™×§×ª ×¨×§×¢</span>
                </div>
                <div class="toggle-switch" id="musicToggle" onclick="toggleMusic()">
                    <div class="toggle-slider"></div>
                </div>
            </div>

            <button class="close-settings" onclick="closeSettings()">âœ“ ×¡×’×•×¨</button>
        </div>
    </div>

    <!-- Homepage -->
    <div id="homepage" class="page active">
        <div class="container">
            <h1>ğŸ® ××•×›× ×™× ×œ×›×™×ª×” ×'!</h1>
            <p class="subtitle">×œ××™×“×” ××©×—×§×™×ª ×•×”×›× ×” ××•×©×œ××ª ×œ×›×™×ª×” ×'</p>
          
            <h3 style="text-align: center; color: #667eea; margin-bottom: 20px; font-size: 1.5em;">×‘×—×¨×• ××©×—×§</h3>

            <div class="games-grid">
                <div class="game-card pink" onclick="showPage('coloring')">
                    <div class="game-icon">ğŸ¨</div>
                    <div class="game-title">×¦×‘×™×¢×”</div>
                    <div class="game-description">×¦×‘×¢×• ×ª××•× ×•×ª ×™×¤×•×ª ×•×ª×”× ×• ×œ×™×¦×•×¨!</div>
                </div>

                <div class="game-card blue" onclick="showPage('numbers')">
                    <div class="game-icon">ğŸ”¢</div>
                    <div class="game-title">××¡×¤×¨×™×</div>
                    <div class="game-description">×œ××“×• ××¡×¤×¨×™× ×-1 ×¢×“ 10</div>
                </div>

                <div class="game-card orange" onclick="showPage('letters')">
                    <div class="game-icon">ğŸ”¤</div>
                    <div class="game-title">××•×ª×™×•×ª</div>
                    <div class="game-description">×œ××“×• ××ª ×”××œ×£-×‘×™×ª ×”×¢×‘×¨×™</div>
                </div>

                <div class="game-card green" onclick="showPage('shapes')">
                    <div class="game-icon">â­</div>
                    <div class="game-title">×¦×•×¨×•×ª</div>
                    <div class="game-description">×–×”×• ×¦×•×¨×•×ª ×©×•× ×•×ª</div>
                </div>

                <div class="game-card yellow" onclick="showPage('matching')">
                    <div class="game-icon">ğŸ§©</div>
                    <div class="game-title">×”×ª×××”</div>
                    <div class="game-description">×”×ª××™××• ××¡×¤×¨×™× ×œ×›××•×™×•×ª</div>
                </div>

                <div class="game-card purple" onclick="showPage('memory')">
                    <div class="game-icon">ğŸ§ </div>
                    <div class="game-title">×–×™×›×¨×•×Ÿ</div>
                    <div class="game-description">××©×—×§ ×–×™×›×¨×•×Ÿ ×××ª×’×¨</div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <button class="action-button" onclick="showPage('printables')" style="font-size: 1.3em; padding: 20px 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                    ğŸ–¨ï¸ ×“×¤×™ ×¤×¢×™×œ×•×ª ×œ×”×“×¤×¡×”
                </button>
            </div>
        </div>
    </div>

    <!-- Printables Page -->
    <div id="printables" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×—×–×¨×”</button>

            <div class="game-header">
                <h2>ğŸ–¨ï¸ ×“×¤×™ ×¤×¢×™×œ×•×ª ×œ×”×“×¤×¡×”</h2>
                <p>×‘×—×¨×• ×“×£ ×œ×”×“×¤×¡×”</p>
            </div>

            <div style="text-align: center; margin-bottom: 30px;">
                <button class="action-button" onclick="printCurrentSheet()" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                    ğŸ–¨ï¸ ×”×“×¤×¡ ×“×£ ×–×”
                </button>
            </div>

            <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
                <button class="action-button" onclick="previousSheet()">â¬…ï¸ ×“×£ ×§×•×“×</button>
                <span id="sheetIndicator" style="font-size: 1.3em; color: #667eea; font-weight: bold; display: flex; align-items: center;"></span>
                <button class="action-button" onclick="nextSheet()">â¡ï¸ ×“×£ ×”×‘×</button>
            </div>

            <!-- Sheet 1: Letter Writing Practice -->
            <div id="sheet1" class="printable-sheet" style="display: block;">
                <div style="background: white; padding: 40px; border-radius: 20px; max-width: 900px; margin: 0 auto;">
                    <h2 style="text-align: center; color: #667eea; margin-bottom: 10px;">×ª×¨×’×•×œ ×›×ª×™×‘×ª ××•×ª×™×•×ª</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 30px;">×¢×§×‘×• ××—×¨×™ ×”××•×ª×™×•×ª ×”××§×•×•×§×•×•×ª ×•×›×ª×‘×• ×‘×¢×¦××›×</p>

                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">× ×</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×‘ ×‘</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×’ ×’</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×“ ×“</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×” ×”</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×• ×•</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×– ×–</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×— ×—</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×˜ ×˜</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×™ ×™</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×› ×›</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×œ ×œ</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">× ×</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×  × </div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×¡ ×¡</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×¢ ×¢</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×¤ ×¤</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×¦ ×¦</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×§ ×§</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×¨ ×¨</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×© ×©</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                        <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center;">
                            <div style="font-size: 3em; color: #ccc; font-weight: bold; margin-bottom: 10px;">×ª ×ª</div>
                            <div style="border-bottom: 2px dotted #999; margin: 5px 0; height: 40px;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sheet 2: Number Writing Practice -->
            <div id="sheet2" class="printable-sheet" style="display: none;">
                <div style="background: white; padding: 40px; border-radius: 20px; max-width: 900px; margin: 0 auto;">
                    <h2 style="text-align: center; color: #667eea; margin-bottom: 10px;">×¡×¤×™×¨×” ×•××¡×¤×¨×™×</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 30px;">×¡×¤×¨×• ××ª ×”××•×‘×™×™×§×˜×™× ×•×›×ª×‘×• ××ª ×”××¡×¤×¨</p>

                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">â­â­â­</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸŠğŸŠğŸŠğŸŠğŸŠğŸŠğŸŠ</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸŸğŸŸğŸŸğŸŸğŸŸğŸŸğŸŸğŸŸğŸŸ</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ‹ğŸ‹</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸˆğŸˆğŸˆğŸˆğŸˆğŸˆ</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸŒºğŸŒºğŸŒºğŸŒº</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>

                        <div style="border: 2px solid #4facfe; border-radius: 15px; padding: 20px; text-align: center;">
                            <div style="font-size: 2.5em; margin-bottom: 10px;">ğŸ“ğŸ“ğŸ“ğŸ“ğŸ“ğŸ“ğŸ“ğŸ“</div>
                            <div style="font-size: 1.2em; color: #666; margin: 10px 0;">×›××”?</div>
                            <div style="border: 2px dashed #999; border-radius: 10px; height: 60px; display: flex; align-items: center; justify-content: center; font-size: 2.5em; color: #ccc;">___</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sheet 3: Shape Recognition -->
            <div id="sheet3" class="printable-sheet" style="display: none;">
                <div style="background: white; padding: 40px; border-radius: 20px; max-width: 800px; margin: 0 auto;">
                    <h2 style="text-align: center; color: #667eea; margin-bottom: 10px;">×–×™×”×•×™ ×¦×•×¨×•×ª</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 30px;">×¦×‘×¢×• ×›×œ ×¦×•×¨×” ×‘×¦×‘×¢ ×©×•× ×”</p>

                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                        <div style="border: 2px solid #30cfd0; border-radius: 15px; padding: 30px; text-align: center;">
                            <div style="width: 100px; height: 100px; border: 4px solid #333; border-radius: 10px; margin: 0 auto 15px;"></div>
                            <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">×¨×™×‘×•×¢</div>
                        </div>

                        <div style="border: 2px solid #30cfd0; border-radius: 15px; padding: 30px; text-align: center;">
                            <div style="width: 100px; height: 100px; border: 4px solid #333; border-radius: 50%; margin: 0 auto 15px;"></div>
                            <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">×¢×™×’×•×œ</div>
                        </div>

                        <div style="border: 2px solid #30cfd0; border-radius: 15px; padding: 30px; text-align: center;">
                            <div style="width: 0; height: 0; border-left: 50px solid transparent; border-right: 50px solid transparent; border-bottom: 100px solid #333; margin: 0 auto 15px;"></div>
                            <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">××©×•×œ×©</div>
                        </div>

                        <div style="border: 2px solid #30cfd0; border-radius: 15px; padding: 30px; text-align: center;">
                            <svg width="100" height="100" style="margin: 0 auto 15px; display: block;">
                                <polygon points="50,10 61,35 90,35 67,52 77,77 50,60 23,77 33,52 10,35 39,35" fill="white" stroke="#333" stroke-width="4"/>
                            </svg>
                            <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">×›×•×›×‘</div>
                        </div>

                        <div style="border: 2px solid #30cfd0; border-radius: 15px; padding: 30px; text-align: center;">
                            <svg width="100" height="100" style="margin: 0 auto 15px; display: block;">
                                <path d="M50,25 C30,10 10,25 10,45 C10,70 50,90 50,90 C50,90 90,70 90,45 C90,25 70,10 50,25 Z" fill="white" stroke="#333" stroke-width="4"/>
                            </svg>
                            <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">×œ×‘</div>
                        </div>

                        <div style="border: 2px solid #30cfd0; border-radius: 15px; padding: 30px; text-align: center;">
                            <svg width="100" height="100" style="margin: 0 auto 15px; display: block;">
                                <polygon points="50,10 70,40 50,70 30,40" fill="white" stroke="#333" stroke-width="4"/>
                            </svg>
                            <div style="font-size: 1.5em; color: #667eea; font-weight: bold;">×™×”×œ×•×</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sheet 4: Matching Activity -->
            <div id="sheet4" class="printable-sheet" style="display: none;">
                <div style="background: white; padding: 40px; border-radius: 20px; max-width: 900px; margin: 0 auto;">
                    <h2 style="text-align: center; color: #667eea; margin-bottom: 10px;">×”×ª×××”</h2>
                    <p style="text-align: center; color: #666; margin-bottom: 30px;">×—×‘×¨×• ×‘×™×Ÿ ×”××•×ª ×œ××™×œ×” ×©××ª×—×™×œ×” ×‘×”</p>

                    <!-- ××•×ª×™×•×ª ×œ××¢×œ×” -->
                    <div style="background: #f0f4ff; border-radius: 15px; padding: 25px; margin-bottom: 40px;">
                        <h3 style="text-align: center; color: #667eea; margin-bottom: 20px;">××•×ª×™×•×ª</h3>
                        <div style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px;">
                            <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 3.5em; font-weight: bold; color: #667eea;">×</div>
                            </div>
                            <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 3.5em; font-weight: bold; color: #667eea;">×‘</div>
                            </div>
                            <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 3.5em; font-weight: bold; color: #667eea;">×’</div>
                            </div>
                            <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 3.5em; font-weight: bold; color: #667eea;">×“</div>
                            </div>
                            <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 3.5em; font-weight: bold; color: #667eea;">×”</div>
                            </div>
                            <div style="border: 2px solid #667eea; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 3.5em; font-weight: bold; color: #667eea;">×•</div>
                            </div>
                        </div>
                    </div>

                    <!-- ××™×œ×™× ×œ××˜×” ×‘×¡×“×¨ ××¢×•×¨×‘×‘ -->
                    <div style="background: #fff4e6; border-radius: 15px; padding: 25px;">
                        <h3 style="text-align: center; color: #fa709a; margin-bottom: 20px;">××™×œ×™×</h3>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">
                            <div style="border: 2px solid #fa709a; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 1.5em; color: #666;">×“×’ ğŸŸ</div>
                                <div style="border-top: 2px solid #ccc; margin-top: 10px; padding-top: 10px; min-height: 30px;"></div>
                            </div>
                            <div style="border: 2px solid #fa709a; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 1.5em; color: #666;">×•×¨×“ ğŸŒ¹</div>
                                <div style="border-top: 2px solid #ccc; margin-top: 10px; padding-top: 10px; min-height: 30px;"></div>
                            </div>
                            <div style="border: 2px solid #fa709a; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 1.5em; color: #666;">×‘× × ×” ğŸŒ</div>
                                <div style="border-top: 2px solid #ccc; margin-top: 10px; padding-top: 10px; min-height: 30px;"></div>
                            </div>
                            <div style="border: 2px solid #fa709a; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 1.5em; color: #666;">×”×¨ â›°ï¸</div>
                                <div style="border-top: 2px solid #ccc; margin-top: 10px; padding-top: 10px; min-height: 30px;"></div>
                            </div>
                            <div style="border: 2px solid #fa709a; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 1.5em; color: #666;">×’×œ×™×“×” ğŸ¦</div>
                                <div style="border-top: 2px solid #ccc; margin-top: 10px; padding-top: 10px; min-height: 30px;"></div>
                            </div>
                            <div style="border: 2px solid #fa709a; border-radius: 10px; padding: 15px; text-align: center; background: white;">
                                <div style="font-size: 1.5em; color: #666;">××¨×™×” ğŸ¦</div>
                                <div style="border-top: 2px solid #ccc; margin-top: 10px; padding-top: 10px; min-height: 30px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Coloring Page -->
    <div id="coloring" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×¨××©×™</button>

            <div class="game-header">
                <h2>ğŸ¨ ×¦×‘×™×¢×”</h2>
                <p>×‘×—×¨×• ×¦×‘×¢ ×•×¦×‘×¢×• ×‘×ª××•× ×”!</p>
            </div>

            <div class="coloring-container">
                <div class="canvas-wrapper">
                    <canvas id="coloringCanvas" width="450" height="450"></canvas>
                </div>

                <div class="color-palette" id="colorPalette"></div>

                <div class="brush-sizes">
                    <div class="brush-size" data-size="5" onclick="setBrushSize(5)">
                        <div style="width: 5px; height: 5px; background: white; border-radius: 50%;"></div>
                    </div>
                    <div class="brush-size selected" data-size="10" onclick="setBrushSize(10)">
                        <div style="width: 10px; height: 10px; background: white; border-radius: 50%;"></div>
                    </div>
                    <div class="brush-size" data-size="20" onclick="setBrushSize(20)">
                        <div style="width: 20px; height: 20px; background: white; border-radius: 50%;"></div>
                    </div>
                    <div class="brush-size" data-size="30" onclick="setBrushSize(30)">
                        <div style="width: 25px; height: 25px; background: white; border-radius: 50%;"></div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="action-button" onclick="clearCanvas()">ğŸ—‘ï¸ × ×§×” ×”×›×œ</button>
                    <button class="action-button" onclick="saveDrawing()">ğŸ’¾ ×©××•×¨</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Numbers Page -->
    <div id="numbers" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×—×–×¨×”</button>

            <div class="game-header">
                <h2>ğŸ”¢ ××¡×¤×¨×™×</h2>
                <p>×‘×—×¨×• ××©×—×§</p>
            </div>

            <div class="games-grid" style="grid-template-columns: repeat(4, 1fr); max-width: 1200px; margin: 0 auto 30px;">
                <div class="game-card blue" onclick="showNumberGame('learn')">
                    <div class="game-icon">ğŸ“š</div>
                    <div class="game-title">×œ××™×“×ª ××¡×¤×¨×™×</div>
                    <div class="game-description">×œ×—×¦×• ×¢×œ ××¡×¤×¨ ×›×“×™ ×œ×©××•×¢</div>
                </div>
                <div class="game-card green" onclick="showNumberGame('count')">
                    <div class="game-icon">ğŸ¯</div>
                    <div class="game-title">×¡×¤×™×¨×” ×•×’×¨×™×¨×”</div>
                    <div class="game-description">×¡×¤×¨×• ×•×’×¨×¨×• ××ª ×”××¡×¤×¨</div>
                </div>
                <div class="game-card purple" onclick="showNumberGame('sequence')">
                    <div class="game-icon">ğŸ”¢</div>
                    <div class="game-title">×”×©×œ××ª ×¨×¦×£</div>
                    <div class="game-description">××¦××• ××ª ×”××¡×¤×¨ ×”×—×¡×¨</div>
                </div>
                <div class="game-card orange" onclick="showNumberGame('write')">
                    <div class="game-icon">âœï¸</div>
                    <div class="game-title">×›×ª×™×‘×ª ××¡×¤×¨×™×</div>
                    <div class="game-description">×ª×¨×’×œ×• ×›×ª×™×‘×” ×¢×œ ×”××¡×¤×¨×™×</div>
                </div>
            </div>

            <div id="numberLearnMode" style="display: none;">
                <button class="back-button" onclick="backToNumberGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××¡×¤×¨×™×</button>
                <div class="numbers-grid" id="numbersGrid"></div>
            </div>

            <div id="numberCountMode" style="display: none;">
                <button class="back-button" onclick="backToNumberGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××¡×¤×¨×™×</button>
                <div class="game-header">
                    <h3 style="font-size: 2em; color: #667eea;">×›××” ×™×©?</h3>
                </div>
                <div id="countObjectsDisplay" style="font-size: 2.5em; text-align: center; margin: 10px 0; min-height: 60px;"></div>
                <div id="dragNumberTarget" style="min-height: 100px; background: #f0f4ff; border: 3px dashed #667eea; border-radius: 15px; display: flex; align-items: center; justify-content: center; margin: 10px auto; max-width: 300px; font-size: 3em; transition: all 0.3s ease;"></div>
                <div id="dragNumberOptions" style="display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin-top: 10px;"></div>
            </div>

            <div id="numberSequenceMode" style="display: none;">
                <button class="back-button" onclick="backToNumberGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××¡×¤×¨×™×</button>
                <div class="game-header">
                    <h3 style="font-size: 2em; color: #667eea;">××¦××• ××ª ×”××¡×¤×¨ ×”×—×¡×¨</h3>
                </div>
                <div id="sequenceDisplay" style="display: flex; justify-content: center; align-items: center; gap: 12px; margin: 15px 0; flex-wrap: wrap;"></div>
                <div id="sequenceOptions" style="display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin-top: 10px;"></div>
            </div>

            <div id="numberWriteMode" style="display: none;">
                <button class="back-button" onclick="backToNumberGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××¡×¤×¨×™×</button>
                <div class="game-header">
                    <h3 style="font-size: 2em; color: #667eea;">×ª×¨×’×œ×• ×›×ª×™×‘×ª ××¡×¤×¨×™×</h3>
                    <p id="currentWriteNumber" style="font-size: 3em; margin: 20px 0;"></p>
                </div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <canvas id="numberWriteCanvas" width="500" height="500" style="border: 4px solid #667eea; border-radius: 20px; background: white; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); cursor: crosshair;"></canvas>
                </div>
                <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                    <button class="action-button" onclick="clearNumberCanvas()">ğŸ—‘ï¸ × ×§×”</button>
                    <button class="action-button" onclick="nextNumber()">â¡ï¸ ××¡×¤×¨ ×”×‘×</button>
                    <button class="action-button" onclick="previousNumber()">â¬…ï¸ ××¡×¤×¨ ×§×•×“×</button>
                </div>
                <div id="numberNavigation" style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-top: 30px; max-width: 600px; margin-left: auto; margin-right: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Letters Page -->
    <div id="letters" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×—×–×¨×”</button>

            <div class="game-header">
                <h2>ğŸ”¤ ××•×ª×™×•×ª</h2>
                <p>×‘×—×¨×• ××©×—×§</p>
            </div>

            <div class="games-grid" style="grid-template-columns: repeat(4, 1fr); max-width: 1200px; margin: 0 auto 30px;">
                <div class="game-card orange" onclick="showLetterGame('learn')">
                    <div class="game-icon">ğŸ“š</div>
                    <div class="game-title">×œ××™×“×ª ××•×ª×™×•×ª</div>
                    <div class="game-description">×œ×—×¦×• ×¢×œ ××•×ª ×›×“×™ ×œ×©××•×¢</div>
                </div>
                <div class="game-card pink" onclick="showLetterGame('drag')">
                    <div class="game-icon">ğŸ¯</div>
                    <div class="game-title">××©×—×§ ×’×¨×™×¨×”</div>
                    <div class="game-description">×’×¨×¨×• ××ª ×”××•×ª ×”× ×›×•× ×”</div>
                </div>
                <div class="game-card green" onclick="showLetterGame('sequence')">
                    <div class="game-icon">ğŸ”¤</div>
                    <div class="game-title">×”×©×œ××ª ×¨×¦×£</div>
                    <div class="game-description">××¦××• ××ª ×”××•×ª ×”×—×¡×¨×”</div>
                </div>
                <div class="game-card purple" onclick="showLetterGame('write')">
                    <div class="game-icon">âœï¸</div>
                    <div class="game-title">×›×ª×™×‘×ª ××•×ª×™×•×ª</div>
                    <div class="game-description">×ª×¨×’×œ×• ×›×ª×™×‘×” ×¢×œ ×”××•×ª×™×•×ª</div>
                </div>
            </div>

            <div id="letterLearnMode" style="display: none;">
                <button class="back-button" onclick="backToLetterGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××•×ª×™×•×ª</button>
                <div class="letters-grid" id="lettersGrid"></div>
            </div>

            <div id="letterDragMode" style="display: none;">
                <button class="back-button" onclick="backToLetterGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××•×ª×™×•×ª</button>
                <div class="game-header">
                    <h3 id="dragLetterQuestion" style="font-size: 2em; color: #667eea;"></h3>
                </div>
                <div id="dragLetterTarget" style="min-height: 100px; background: #f0f4ff; border: 3px dashed #667eea; border-radius: 15px; display: flex; align-items: center; justify-content: center; margin: 10px auto; max-width: 300px; font-size: 3em; transition: all 0.3s ease;"></div>
                <div id="dragLetterOptions" style="display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; margin-top: 10px;"></div>
            </div>

            <div id="letterSequenceMode" style="display: none;">
                <button class="back-button" onclick="backToLetterGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××•×ª×™×•×ª</button>
                <div class="game-header">
                    <h3 style="font-size: 2em; color: #667eea;">××¦××• ××ª ×”××•×ª ×”×—×¡×¨×”</h3>
                </div>
                <div id="letterSequenceDisplay" style="display: flex; justify-content: center; align-items: center; gap: 20px; margin: 40px 0; flex-wrap: wrap;"></div>
                <div id="letterSequenceOptions" style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 30px;"></div>
            </div>

            <div id="letterWriteMode" style="display: none;">
                <button class="back-button" onclick="backToLetterGames()">â† ×—×–×¨×” ×œ××©×—×§×™ ××•×ª×™×•×ª</button>
                <div class="game-header">
                    <h3 style="font-size: 2em; color: #667eea;">×ª×¨×’×œ×• ×›×ª×™×‘×ª ××•×ª×™×•×ª</h3>
                    <p id="currentWriteLetter" style="font-size: 3em; margin: 20px 0;"></p>
                </div>
                <div style="text-align: center; margin-bottom: 20px;">
                    <canvas id="letterWriteCanvas" width="500" height="500" style="border: 4px solid #667eea; border-radius: 20px; background: white; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); cursor: crosshair;"></canvas>
                </div>
                <div style="display: flex; justify-content: center; gap: 15px; margin-top: 20px;">
                    <button class="action-button" onclick="clearLetterCanvas()">ğŸ—‘ï¸ × ×§×”</button>
                    <button class="action-button" onclick="nextLetter()">â¡ï¸ ××•×ª ×”×‘××”</button>
                    <button class="action-button" onclick="previousLetter()">â¬…ï¸ ××•×ª ×§×•×“××ª</button>
                </div>
                <div id="letterNavigation" style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-top: 30px; max-width: 800px; margin-left: auto; margin-right: auto;"></div>
            </div>
        </div>
    </div>

    <!-- Shapes Page -->
    <div id="shapes" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×—×–×¨×”</button>

            <div class="game-header">
                <h2>â­ ×¦×•×¨×•×ª</h2>
                <p>×œ××“×• ×œ×–×”×•×ª ×¦×•×¨×•×ª ×©×•× ×•×ª</p>
            </div>

            <div class="shapes-grid">
                <div class="shape-card" onclick="speakText('×¢×™×’×•×œ')">
                    <div class="shape-icon">ğŸ”´</div>
                    <div class="shape-name">×¢×™×’×•×œ</div>
                </div>
                <div class="shape-card" onclick="speakText('×¨×™×‘×•×¢')">
                    <div class="shape-icon">ğŸŸ¦</div>
                    <div class="shape-name">×¨×™×‘×•×¢</div>
                </div>
                <div class="shape-card" onclick="speakText('××©×•×œ×©')">
                    <div class="shape-icon">ğŸ”º</div>
                    <div class="shape-name">××©×•×œ×©</div>
                </div>
                <div class="shape-card" onclick="speakText('×›×•×›×‘')">
                    <div class="shape-icon">â­</div>
                    <div class="shape-name">×›×•×›×‘</div>
                </div>
                <div class="shape-card" onclick="speakText('×œ×‘')">
                    <div class="shape-icon">â¤ï¸</div>
                    <div class="shape-name">×œ×‘</div>
                </div>
                <div class="shape-card" onclick="speakText('×™×”×œ×•×')">
                    <div class="shape-icon">ğŸ’</div>
                    <div class="shape-name">×™×”×œ×•×</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Matching Page -->
    <div id="matching" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×—×–×¨×”</button>

            <div class="game-header">
                <h2>ğŸ§© ×”×ª×××”</h2>
                <p>×”×ª××™××• ××ª ×”××¡×¤×¨ ×œ×›××•×ª ×”× ×›×•× ×”</p>
            </div>

            <div class="matching-container">
                <div class="matching-items" id="matchingItems"></div>
                <div class="answer-options" id="answerOptions"></div>
            </div>
        </div>
    </div>

    <!-- Memory Game Page -->
    <div id="memory" class="page">
        <div class="container">
            <button class="back-button" onclick="showPage('homepage')">â† ×—×–×¨×”</button>

            <div class="game-header">
                <h2>ğŸ§  ×–×™×›×¨×•×Ÿ</h2>
                <p>××¦××• ××ª ×”×–×•×’×•×ª ×”×ª×•×××™×</p>
            </div>

            <div class="memory-stats">
                <span>××”×œ×›×™×: <strong id="moves">0</strong></span>
                <span style="margin: 0 20px;">|</span>
                <span>×–×•×’×•×ª: <strong id="pairs">0/8</strong></span>
            </div>

            <div class="memory-grid" id="memoryGrid"></div>

            <div class="action-buttons">
                <button class="action-button" onclick="resetMemoryGame()">ğŸ”„ ×”×ª×—×œ ××—×“×©</button>
            </div>
        </div>
    </div>

    <script>
        // Settings - Load from localStorage
        let soundEnabled = localStorage.getItem('soundEnabled') !== 'false';
        let musicEnabled = localStorage.getItem('musicEnabled') === 'true';

        // Initialize UI based on saved settings
        window.addEventListener('DOMContentLoaded', () => {
            const soundToggle = document.getElementById('soundToggle');
            const musicToggle = document.getElementById('musicToggle');

            if (soundEnabled) {
                soundToggle.classList.add('active');
            } else {
                soundToggle.classList.remove('active');
            }

            if (musicEnabled) {
                musicToggle.classList.add('active');
            } else {
                musicToggle.classList.remove('active');
            }
        });

        function openSettings() {
            document.getElementById('settingsModal').classList.add('active');
        }

        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        function closeSettingsOnBackdrop(event) {
            if (event.target.id === 'settingsModal') {
                closeSettings();
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            localStorage.setItem('soundEnabled', soundEnabled);
            const toggle = document.getElementById('soundToggle');

            if (soundEnabled) {
                toggle.classList.add('active');
                speakText('×”×©××¢×ª ×©××¢ ×¤×•×¢×œ×ª');
            } else {
                toggle.classList.remove('active');
                // Stop any playing audio
                if (window.currentAudio) {
                    window.currentAudio.pause();
                    window.currentAudio = null;
                }
                speechSynthesis.cancel();
            }
        }

        function toggleMusic() {
            musicEnabled = !musicEnabled;
            localStorage.setItem('musicEnabled', musicEnabled);
            const toggle = document.getElementById('musicToggle');

            if (musicEnabled) {
                toggle.classList.add('active');
                // ×›××Ÿ ××¤×©×¨ ×œ×”×•×¡×™×£ ××•×–×™×§×ª ×¨×§×¢ ×‘×¢×ª×™×“
                if (soundEnabled) speakText('××•×–×™×§×ª ×¨×§×¢ ×”×•×¤×¢×œ×”');
            } else {
                toggle.classList.remove('active');
                if (soundEnabled) speakText('××•×–×™×§×ª ×¨×§×¢ ×›×‘×•×™×”');
            }
        }

        // Page Navigation
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');

            // Initialize page-specific content and announce
            if (pageId === 'coloring') {
                initColoring();
                setTimeout(() => speakText('×¦×‘×™×¢×”. ×‘×—×¨×• ×¦×‘×¢ ×•×¦×‘×¢×• ×‘×ª××•× ×”!'), 300);
            }
            if (pageId === 'numbers') {
                initNumbers();
                setTimeout(() => speakText('××©×—×§ ××¡×¤×¨×™×. ×œ×—×¦×• ×¢×œ ××¡×¤×¨ ×›×“×™ ×œ×©××•×¢ ××•×ª×•'), 300);
            }
            if (pageId === 'letters') {
                initLetters();
                setTimeout(() => speakText('××©×—×§ ××•×ª×™×•×ª. ×œ×—×¦×• ×¢×œ ××•×ª ×›×“×™ ×œ×©××•×¢ ××•×ª×”'), 300);
            }
            if (pageId === 'matching') {
                initMatching();
                setTimeout(() => speakText('××©×—×§ ×”×ª×××”. ×”×ª××™××• ××ª ×”××¡×¤×¨ ×œ×›××•×ª'), 300);
            }
            if (pageId === 'memory') {
                initMemory();
                setTimeout(() => speakText('××©×—×§ ×–×™×›×¨×•×Ÿ. ××¦××• ××ª ×”×–×•×’×•×ª ×”×ª×•×××™×'), 300);
            }
            if (pageId === 'shapes') {
                setTimeout(() => speakText('××©×—×§ ×¦×•×¨×•×ª. ×œ×—×¦×• ×¢×œ ×¦×•×¨×” ×›×“×™ ×œ×©××•×¢ ××ª ×©××”'), 300);
            }
            if (pageId === 'printables') {
                updateSheetDisplay();
                setTimeout(() => speakText('×“×¤×™ ×¤×¢×™×œ×•×ª ×œ×”×“×¤×¡×”. ×‘×—×¨×• ×“×£ ×•×œ×—×¦×• ×¢×œ ×”×“×¤×¡'), 300);
            }
        }

        // Text to Speech - ×§×¨×™×™× ×•×ª ×‘×¢×‘×¨×™×ª ×¢× Web Speech API
        let voicesLoaded = false;
        let availableVoices = [];
        let isSpeaking = false;
        let speechInitialized = false;
        let speechRetryCount = 0;
        const MAX_SPEECH_RETRIES = 1;

        // ×˜×¢×Ÿ ×§×•×œ×•×ª ×‘×”×ª×—×œ×” ×•×‘×›×œ ×¤×¢× ×©××ª×¢×“×›× ×™×
        function loadVoices() {
            return new Promise((resolve) => {
                availableVoices = speechSynthesis.getVoices();
                if (availableVoices.length > 0) {
                    voicesLoaded = true;
                    console.log('Voices loaded:', availableVoices.length);
                    resolve(availableVoices);
                } else {
                    // ×× ××™×Ÿ ×§×•×œ×•×ª, × ×¡×” ×©×•×‘ ××—×¨×™ 100ms
                    setTimeout(() => {
                        availableVoices = speechSynthesis.getVoices();
                        if (availableVoices.length > 0) {
                            voicesLoaded = true;
                            console.log('Voices loaded (delayed):', availableVoices.length);
                        }
                        resolve(availableVoices);
                    }, 100);
                }
            });
        }

        // ××ª×—×œ ××ª ××¢×¨×›×ª ×”×§×•×œ ×‘×”×§×©×” ×”×¨××©×•× ×” (× ×“×¨×© ×œ×›×¨×•× ×•×× ×“×¨×•××™×“)
        function initializeSpeech() {
            if (speechInitialized) return;

            speechSynthesis.cancel();
            speechSynthesis.resume();
            speechInitialized = true;
            console.log('Speech initialized by user interaction');
        }

        // ×˜×¢×Ÿ ×§×•×œ×•×ª ×›×©×”×“×£ × ×˜×¢×Ÿ ×•×‘×›×œ ×¤×¢× ×©×”× ××©×ª× ×™×
        if ('speechSynthesis' in window) {
            // Chrome ×¦×¨×™×š ××ª ×–×”
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = loadVoices;
            }

            // ×˜×¢×Ÿ ××™×“
            loadVoices();

            // ×˜×¢×Ÿ ×©×•×‘ ××—×¨×™ ×©×”×“×£ × ×˜×¢×Ÿ (×œ×›×¨×•× ×•×× ×“×¨×•××™×“)
            window.addEventListener('load', () => {
                setTimeout(loadVoices, 100);
            });

            // ××ª×—×œ ××ª ×”×§×•×œ ×‘×”×§×©×” ×”×¨××©×•× ×” ×©×œ ×”××©×ª××© (× ×“×¨×© ×œ×›×¨×•×)
            document.addEventListener('click', initializeSpeech, { once: true });
            document.addEventListener('touchstart', initializeSpeech, { once: true });
        }

        function speakText(text) {
            // ×‘×“×•×§ ×× ×”×©××¢ ××•×¤×¢×œ
            if (!soundEnabled) {
                return;
            }

            // ×‘×“×•×§ ×× ×™×© ×ª××™×›×” ×‘-Speech Synthesis
            if (!('speechSynthesis' in window)) {
                console.warn('Speech Synthesis ×œ× × ×ª××š ×‘×“×¤×“×¤×Ÿ ×–×”');
                return;
            }

            // ×× ×¢ ×“×™×‘×•×¨ ×›×¤×•×œ - ××¡×•×¨ ×œ× ×¡×•×ª ×œ×“×‘×¨ ×× ×›×‘×¨ ××“×‘×¨×™×
            if (isSpeaking) {
                console.log('Already speaking, ignoring request');
                return;
            }

            // ××™×¤×•×¡ ××•× ×” ×”× ×™×¡×™×•× ×•×ª
            speechRetryCount = 0;

            // ×¢×¦×•×¨ ××ª ×›×œ ×”×”×©××¢×•×ª ×”×§×•×“××•×ª
            speechSynthesis.cancel();

            // ×”×•×¡×£ ××¤×§×˜ ×•×™×–×•××œ×™ ×‘×–××Ÿ ×”×“×™×‘×•×¨
            const element = event?.currentTarget;
            if (element) {
                element.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    element.style.transform = '';
                }, 300);
            }

            // ×¤×•× ×§×¦×™×” ×œ×‘×™×¦×•×¢ ×”×“×™×‘×•×¨
            async function performSpeak() {
                // ×•×“× ×©×”×§×•×œ×•×ª × ×˜×¢× ×•
                if (!voicesLoaded || availableVoices.length === 0) {
                    await loadVoices();
                }

                const utterance = new SpeechSynthesisUtterance(text);

                // ×—×¤×© ×§×•×œ ×¢×‘×¨×™
                let hebrewVoice = availableVoices.find(voice =>
                    voice.lang.includes('he') || voice.lang.includes('iw')
                );

                // ×× ×œ× ××¦×× ×• ×§×•×œ ×¢×‘×¨×™, × ×¡×” ×©×•×‘ ×œ×˜×¢×•×Ÿ
                if (!hebrewVoice && availableVoices.length === 0) {
                    await loadVoices();
                    hebrewVoice = availableVoices.find(voice =>
                        voice.lang.includes('he') || voice.lang.includes('iw')
                    );
                }

                if (hebrewVoice) {
                    utterance.voice = hebrewVoice;
                    console.log('Using Hebrew voice:', hebrewVoice.name);
                } else {
                    console.log('No Hebrew voice found, using default');
                }

                utterance.lang = 'he-IL';
                utterance.rate = 0.8;
                utterance.pitch = 1.2;
                utterance.volume = 1.0;

                // Event listeners ×œ×˜×™×¤×•×œ ×‘×©×’×™××•×ª
                utterance.onstart = () => {
                    isSpeaking = true;
                    console.log('Speech started');
                };

                utterance.onend = () => {
                    isSpeaking = false;
                    speechRetryCount = 0;
                    console.log('Speech ended');
                };

                utterance.onerror = (event) => {
                    console.error('Speech error:', event.error);
                    isSpeaking = false;

                    // ×× ×™×¢×ª ×œ×•×¤ ××™× ×¡×•×¤×™ - × ×¡×” ×©×•×‘ ×¨×§ ×¤×¢× ××—×ª ×•×¨×§ ×× ×œ× × ×™×¡×™× ×• ×›×‘×¨
                    if (speechRetryCount < MAX_SPEECH_RETRIES &&
                        (event.error === 'not-allowed' || event.error === 'canceled')) {
                        speechRetryCount++;
                        console.log(`Retrying speech (attempt ${speechRetryCount}/${MAX_SPEECH_RETRIES})`);
                        setTimeout(() => {
                            if (!isSpeaking) {
                                speechSynthesis.cancel();
                                speechSynthesis.speak(utterance);
                            }
                        }, 100);
                    } else {
                        speechRetryCount = 0;
                        console.log('Speech retry limit reached or permanent error');
                    }
                };

                // ×“×‘×¨!
                try {
                    speechSynthesis.speak(utterance);
                } catch (error) {
                    console.error('Speech failed:', error);
                    isSpeaking = false;
                    speechRetryCount = 0;
                }
            }

            // ×”×¤×¢×œ ××ª ×”×“×™×‘×•×¨
            performSpeak();
        }

        // Coloring Page
        let canvas, ctx, isDrawing = false;
        let currentColor = '#FF6B6B';
        let brushSize = 10;

        function initColoring() {
            canvas = document.getElementById('coloringCanvas');
            ctx = canvas.getContext('2d');

            // Set white background
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Create color palette
            const colors = [
                '#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8',
                '#F7DC6F', '#BB8FCE', '#85C1E2', '#F8B88B', '#FAD7A6',
                '#FF0000', '#00FF00', '#0000FF', '#FFFF00', '#FF00FF',
                '#00FFFF', '#800080', '#FFA500', '#FFB6C1', '#8B4513'
            ];

            const palette = document.getElementById('colorPalette');
            palette.innerHTML = '';
            colors.forEach((color, index) => {
                const colorDiv = document.createElement('div');
                colorDiv.className = 'color-option' + (index === 0 ? ' selected' : '');
                colorDiv.style.background = color;
                colorDiv.onclick = () => selectColor(color, colorDiv);
                palette.appendChild(colorDiv);
            });

            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Touch events for mobile
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function selectColor(color, element) {
            currentColor = color;
            document.querySelectorAll('.color-option').forEach(el => {
                el.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        function setBrushSize(size) {
            brushSize = size;
            document.querySelectorAll('.brush-size').forEach(el => {
                el.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function startDrawing(e) {
            isDrawing = true;
            draw(e);
        }

        function draw(e) {
            if (!isDrawing) return;

            const coords = getCanvasCoordinates(canvas, e.clientX, e.clientY);

            ctx.fillStyle = currentColor;
            ctx.beginPath();
            ctx.arc(coords.x, coords.y, brushSize, 0, Math.PI * 2);
            ctx.fill();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];

            if (e.type === 'touchstart') {
                isDrawing = true;
                const coords = getCanvasCoordinates(canvas, touch.clientX, touch.clientY);
                ctx.fillStyle = currentColor;
                ctx.beginPath();
                ctx.arc(coords.x, coords.y, brushSize, 0, Math.PI * 2);
                ctx.fill();
            } else if (e.type === 'touchmove' && isDrawing) {
                const coords = getCanvasCoordinates(canvas, touch.clientX, touch.clientY);
                ctx.fillStyle = currentColor;
                ctx.beginPath();
                ctx.arc(coords.x, coords.y, brushSize, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function clearCanvas() {
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function saveDrawing() {
            const link = document.createElement('a');
            link.download = '×”×¦×™×•×¨-×©×œ×™.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        // Numbers Page
        function initNumbers() {
            const numbers = [
                { num: 1, word: '××—×ª', emoji: 'ğŸ¶' },
                { num: 2, word: '×©×ª×™×™×', emoji: 'ğŸŠğŸŠ' },
                { num: 3, word: '×©×œ×•×©', emoji: 'ğŸ‹ğŸ‹ğŸ‹' },
                { num: 4, word: '×Ö·×¨×‘×¢', emoji: 'ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹' },
                { num: 5, word: '×—××©', emoji: 'ğŸ“ğŸ“ğŸ“ğŸ“ğŸ“' },
                { num: 6, word: '×©×©', emoji: 'ğŸ±ğŸ±ğŸ±ğŸ±ğŸ±ğŸ±' },
                { num: 7, word: '×©×‘×¢', emoji: 'â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸â¤ï¸' },
                { num: 8, word: '×©××•× ×”', emoji: 'ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ' },
                { num: 9, word: '×ª×©×¢', emoji: 'ğŸğŸğŸğŸğŸğŸğŸğŸğŸ' },
                { num: 10, word: '×¢×©×¨', emoji: 'ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ' }
            ];

            const grid = document.getElementById('numbersGrid');
            grid.innerHTML = '';

            numbers.forEach(item => {
                const card = document.createElement('div');
                card.className = 'number-card';
                card.innerHTML = `
                    <div class="number-value">${item.num}</div>
                    <div class="number-word">${item.word}</div>
                    <div class="number-objects">${item.emoji}</div>
                `;
                card.onclick = () => speakText(item.word);
                grid.appendChild(card);
            });
        }

        // Letters Page
        function initLetters() {
            const letters = [
                { letter: '×', name: '×Ö¸×œÖ¶×£' },
                { letter: '×‘', name: '×‘ÖµÖ¼×™×ª' },
                { letter: '×’', name: '×’Ö´×™×Ö¶×œ' },
                { letter: '×“', name: '×“Ö¸×œÖ¶×ª' },
                { letter: '×”', name: '×”Öµ×' },
                { letter: '×•', name: '×•Ö¸×•' },
                { letter: '×–', name: '×–Ö·×™Ö´×Ÿ' },
                { letter: '×—', name: '×—Öµ×™×ª' },
                { letter: '×˜', name: '×˜Öµ×™×ª' },
                { letter: '×™', name: '×™×•Ö¹×“' },
                { letter: '×›', name: '×›Ö·Ö¼×£' },
                { letter: '×œ', name: '×œÖ¸×Ö¶×“' },
                { letter: '×', name: '×Öµ×' },
                { letter: '× ', name: '× ×•Ö¼×Ÿ' },
                { letter: '×¡', name: '×¡Ö¸×Ö¶×šÖ°' },
                { letter: '×¢', name: '×¢Ö·×™Ö´×Ÿ' },
                { letter: '×¤', name: '×¤ÖµÖ¼×' },
                { letter: '×¦', name: '×¦Ö¸×“Ö´×™' },
                { letter: '×§', name: '×§×•Ö¹×£' },
                { letter: '×¨', name: '×¨Öµ×™×©×' },
                { letter: '×©', name: '×©Ö´××™×Ÿ' },
                { letter: '×ª', name: '×ªÖ¸×•' }
            ];

            const grid = document.getElementById('lettersGrid');
            grid.innerHTML = '';

            letters.forEach(item => {
                const card = document.createElement('div');
                card.className = 'letter-card';
                card.innerHTML = `
                    <div class="letter-value">${item.letter}</div>
                    <div class="letter-name">${item.name}</div>
                `;
                card.onclick = () => speakText(item.letter);
                grid.appendChild(card);
            });
        }

        // Matching Game
        let currentMatchingQuestion = null;
        let lastMatchingNumber = null;

        function initMatching() {
            lastMatchingNumber = null;
            generateMatchingQuestion();
        }

        function generateMatchingQuestion() {
            const items = [
                { icon: 'ğŸ', label: '×ª×¤×•×— ××—×“', count: 1 },
                { icon: 'ğŸ“ğŸ“', label: '×©×ª×™ ×ª×•×ª×™×', count: 2 },
                { icon: 'â­â­â­', label: '×©×œ×•×©×” ×›×•×›×‘×™×', count: 3 },
                { icon: 'ğŸ¦‹ğŸ¦‹ğŸ¦‹ğŸ¦‹', label: '××¨×‘×¢×” ×¤×¨×¤×¨×™×', count: 4 },
                { icon: 'ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸ğŸŒ¸', label: '×—××™×©×” ×¤×¨×—×™×', count: 5 },
                { icon: 'ğŸŠğŸŠğŸŠğŸŠğŸŠğŸŠ', label: '×©×™×©×” ×ª×¤×•×–×™×', count: 6 },
                { icon: 'ğŸˆğŸˆğŸˆğŸˆğŸˆğŸˆğŸˆ', label: '×©×‘×¢×” ×‘×œ×•× ×™×', count: 7 },
                { icon: 'ğŸ‹ğŸ‹ğŸ‹ğŸ‹ğŸ‹ğŸ‹ğŸ‹ğŸ‹', label: '×©××•× ×” ×œ×™××•× ×™×', count: 8 },
                { icon: 'ğŸ”·ğŸ”·ğŸ”·ğŸ”·ğŸ”·ğŸ”·ğŸ”·ğŸ”·ğŸ”·', label: '×ª×©×¢×” ×™×”×œ×•××™×', count: 9 },
                { icon: 'ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ', label: '×¢×©×¨×” ×›×•×›×‘×™×', count: 10 }
            ];

            // ×‘×—×¨ ×©××œ×” ×—×“×©×” ×©×•× ×” ××”×§×•×“××ª
            let newQuestion;
            do {
                newQuestion = items[Math.floor(Math.random() * items.length)];
            } while (lastMatchingNumber !== null && newQuestion.count === lastMatchingNumber);

            currentMatchingQuestion = newQuestion;
            lastMatchingNumber = currentMatchingQuestion.count;

            const container = document.getElementById('matchingItems');
            container.innerHTML = `
                <div class="matching-item">
                    <div class="item-icon">${currentMatchingQuestion.icon}</div>
                    <div class="item-label">${currentMatchingQuestion.label}</div>
                </div>
            `;

            const options = document.getElementById('answerOptions');
            options.innerHTML = '';

            // ×¦×•×¨ 3 ××¤×©×¨×•×™×•×ª ×ª×©×•×‘×”: ×”×ª×©×•×‘×” ×”× ×›×•× ×” + 2 ×©×’×•×™×•×ª
            const answers = [currentMatchingQuestion.count];

            // ×”×•×¡×£ 2 ××¡×¤×¨×™× ×©×’×•×™×™× ×©×•× ×™×
            while (answers.length < 3) {
                const randomNum = Math.floor(Math.random() * 10) + 1;
                if (!answers.includes(randomNum)) {
                    answers.push(randomNum);
                }
            }

            // ×¢×¨×‘×‘ ××ª ×”×ª×©×•×‘×•×ª
            answers.sort(() => Math.random() - 0.5);

            answers.forEach(num => {
                const option = document.createElement('div');
                option.className = 'answer-option';
                option.textContent = num;
                option.onclick = () => checkMatchingAnswer(num);
                options.appendChild(option);
            });
        }

        function checkMatchingAnswer(selected) {
            const matchingItems = document.getElementById('matchingItems');

            if (selected === currentMatchingQuestion.count) {
                speakText('×›×œ ×”×›×‘×•×“! ×ª×©×•×‘×” × ×›×•× ×”!');
                matchingItems.style.background = '#4CAF50';
                matchingItems.style.borderRadius = '20px';
                matchingItems.style.padding = '20px';

                setTimeout(() => {
                    matchingItems.style.background = '';
                    matchingItems.style.padding = '';
                    generateMatchingQuestion();
                }, 1500);
            } else {
                speakText('× ×¡×• ×©×•×‘');
                matchingItems.style.background = '#f44336';
                matchingItems.style.borderRadius = '20px';
                matchingItems.style.padding = '20px';

                setTimeout(() => {
                    matchingItems.style.background = '';
                    matchingItems.style.padding = '';
                }, 800);
            }
        }

        // Memory Game
        let memoryCards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let moves = 0;

        function initMemory() {
            const emojis = ['ğŸ', 'ğŸŒŸ', 'ğŸ¨', 'ğŸ¦‹', 'ğŸ“', 'âš½', 'ğŸŒˆ', 'ğŸ­'];
            memoryCards = [...emojis, ...emojis].sort(() => Math.random() - 0.5);
            flippedCards = [];
            matchedPairs = 0;
            moves = 0;

            updateMemoryStats();
            renderMemoryGrid();
        }

        function renderMemoryGrid() {
            const grid = document.getElementById('memoryGrid');
            grid.innerHTML = '';

            memoryCards.forEach((emoji, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.innerHTML = `<span class="card-content">${emoji}</span>`;
                card.onclick = () => flipCard(index, card);
                grid.appendChild(card);
            });
        }

        function flipCard(index, cardElement) {
            if (flippedCards.length === 2 || cardElement.classList.contains('flipped') || cardElement.classList.contains('matched')) {
                return;
            }

            cardElement.classList.add('flipped');
            flippedCards.push({ index, element: cardElement, emoji: memoryCards[index] });

            if (flippedCards.length === 2) {
                moves++;
                updateMemoryStats();

                if (flippedCards[0].emoji === flippedCards[1].emoji) {
                    flippedCards.forEach(card => card.element.classList.add('matched'));
                    matchedPairs++;
                    flippedCards = [];
                    updateMemoryStats();

                    // ×§×¨×™×™× ×•×ª ×¢×œ ×–×•×’ ×©× ××¦×
                    speakText('×™×¤×” ×××•×“! ××¦××ª× ×–×•×’!');

                    if (matchedPairs === 8) {
                        setTimeout(() => {
                            speakText('×›×œ ×”×›×‘×•×“! ×¡×™×™××ª× ××ª ×”××©×—×§!');
                            const memoryGrid = document.getElementById('memoryGrid');
                            memoryGrid.style.border = '5px solid #4CAF50';
                            memoryGrid.style.borderRadius = '20px';
                            memoryGrid.style.padding = '20px';
                        }, 500);
                    }
                } else {
                    setTimeout(() => {
                        flippedCards.forEach(card => card.element.classList.remove('flipped'));
                        flippedCards = [];
                    }, 1000);
                }
            }
        }

        function updateMemoryStats() {
            document.getElementById('moves').textContent = moves;
            document.getElementById('pairs').textContent = `${matchedPairs}/8`;
        }

        function resetMemoryGame() {
            initMemory();
        }

        // Letter Games
        function showLetterGame(mode) {
            // ×”×¡×ª×¨ ××ª ×ª×¤×¨×™×˜ ×”××©×—×§×™×
            const lettersPage = document.getElementById('letters');
            const gamesGrid = lettersPage.querySelector('.games-grid');
            gamesGrid.classList.add('hidden');

            // ×”×¡×ª×¨ ××ª ×›×œ ×”××©×—×§×™×
            document.getElementById('letterLearnMode').style.display = 'none';
            document.getElementById('letterDragMode').style.display = 'none';
            document.getElementById('letterSequenceMode').style.display = 'none';
            document.getElementById('letterWriteMode').style.display = 'none';

            // ×”×¦×’ ××ª ×”××©×—×§ ×©× ×‘×—×¨
            if (mode === 'learn') {
                document.getElementById('letterLearnMode').style.display = 'block';
                initLetters();
            } else if (mode === 'drag') {
                document.getElementById('letterDragMode').style.display = 'block';
                initLetterDragGame();
            } else if (mode === 'sequence') {
                document.getElementById('letterSequenceMode').style.display = 'block';
                initLetterSequenceGame();
            } else if (mode === 'write') {
                document.getElementById('letterWriteMode').style.display = 'block';
                initLetterWriteGame();
            }
        }

        function backToLetterGames() {
            // ×”×¦×’ ××ª ×ª×¤×¨×™×˜ ×”××©×—×§×™×
            const lettersPage = document.getElementById('letters');
            const gamesGrid = lettersPage.querySelector('.games-grid');
            gamesGrid.classList.remove('hidden');

            // ×”×¡×ª×¨ ××ª ×›×œ ×”××©×—×§×™×
            document.getElementById('letterLearnMode').style.display = 'none';
            document.getElementById('letterDragMode').style.display = 'none';
            document.getElementById('letterSequenceMode').style.display = 'none';
            document.getElementById('letterWriteMode').style.display = 'none';
        }

        let currentLetterAnswer = null;
        const hebrewLetters = [
            { letter: '×', name: '×Ö¸×œÖ¶×£' },
            { letter: '×‘', name: '×‘ÖµÖ¼×™×ª' },
            { letter: '×’', name: '×’Ö´×™×Ö¶×œ' },
            { letter: '×“', name: '×“Ö¸×œÖ¶×ª' },
            { letter: '×”', name: '×”Öµ×' },
            { letter: '×•', name: '×•Ö¸×•' },
            { letter: '×–', name: '×–Ö·×™Ö´×Ÿ' },
            { letter: '×—', name: '×—Öµ×™×ª' },
            { letter: '×˜', name: '×˜Öµ×™×ª' },
            { letter: '×™', name: '×™×•Ö¼×“' },
            { letter: '×›', name: '×›Ö·Ö¼×£' },
            { letter: '×œ', name: '×œÖ¸×Ö¶×“' }
        ];

        function initLetterDragGame() {
            generateLetterQuestion();
        }

        function generateLetterQuestion() {
            // ×‘×—×¨ ××•×ª ×¨× ×“×•××œ×™×ª
            currentLetterAnswer = hebrewLetters[Math.floor(Math.random() * hebrewLetters.length)];

            // ×”×¦×’ ×©××œ×”
            document.getElementById('dragLetterQuestion').textContent = `×’×¨×¨×• ××ª ×”××•×ª: ${currentLetterAnswer.name}`;
            speakText(currentLetterAnswer.name);

            // × ×§×” ××ª ××–×•×¨ ×”×’×¨×™×¨×”
            const target = document.getElementById('dragLetterTarget');
            target.innerHTML = '';
            target.className = 'drop-zone';
            target.style.background = '#f0f4ff';
            target.style.borderColor = '#667eea';

            // ×¦×•×¨ 4 ××•×ª×™×•×ª ××§×¨××™×•×ª (×›×•×œ×œ ×”×ª×©×•×‘×” ×”× ×›×•× ×”)
            const options = [currentLetterAnswer];
            while (options.length < 4) {
                const randomLetter = hebrewLetters[Math.floor(Math.random() * hebrewLetters.length)];
                if (!options.find(l => l.letter === randomLetter.letter)) {
                    options.push(randomLetter);
                }
            }

            // ×¢×¨×‘×‘ ××ª ×”××¤×©×¨×•×™×•×ª
            options.sort(() => Math.random() - 0.5);

            // ×”×¦×’ ××ª ×”××•×ª×™×•×ª
            const optionsContainer = document.getElementById('dragLetterOptions');
            optionsContainer.innerHTML = '';

            options.forEach(item => {
                const letterDiv = document.createElement('div');
                letterDiv.className = 'draggable-item';
                letterDiv.textContent = item.letter;
                letterDiv.draggable = true;
                letterDiv.dataset.letter = item.letter;

                // Desktop drag events
                letterDiv.addEventListener('dragstart', handleDragStart);
                letterDiv.addEventListener('dragend', handleDragEnd);

                // Mobile touch events - ×’×¨×™×¨×” ××™×™×“×™×ª
                letterDiv.addEventListener('touchstart', handleTouchStart, { passive: false });
                letterDiv.addEventListener('touchmove', handleTouchMove, { passive: false });
                letterDiv.addEventListener('touchend', handleTouchEnd, { passive: false });

                optionsContainer.appendChild(letterDiv);
            });

            // ×”×•×¡×£ event listeners ×œ××–×•×¨ ×”×’×¨×™×¨×”
            target.addEventListener('dragover', handleDragOver);
            target.addEventListener('drop', handleLetterDrop);
            target.addEventListener('dragleave', handleDragLeave);
        }

        // ××©×ª× ×™ ×¢×–×¨ ×œ×’×¨×™×¨×” ×‘××•×‘×™×™×œ
        let touchDragElement = null;
        let touchClone = null;
        let touchStartX = 0;
        let touchStartY = 0;

        function handleDragStart(e) {
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', e.currentTarget.dataset.letter);
        }

        function handleDragEnd(e) {
            e.currentTarget.classList.remove('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleLetterDrop(e) {
            e.preventDefault();
            const target = e.currentTarget;
            target.classList.remove('drag-over');

            const droppedLetter = e.dataTransfer.getData('text/plain');

            if (droppedLetter === currentLetterAnswer.letter) {
                // ×ª×©×•×‘×” × ×›×•× ×”!
                target.innerHTML = droppedLetter;
                target.classList.add('correct');
                speakText('×›×œ ×”×›×‘×•×“!');

                setTimeout(() => {
                    generateLetterQuestion();
                }, 1500);
            } else {
                // ×ª×©×•×‘×” ×©×’×•×™×”
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');

                setTimeout(() => {
                    target.classList.remove('incorrect');
                }, 500);
            }
        }

        // ×¤×•× ×§×¦×™×•×ª Touch ×œ××•×‘×™×™×œ - ×××¤×©×¨×•×ª ×’×¨×™×¨×” ××™×™×“×™×ª ×œ×œ× ×œ×—×™×¦×” ××¨×•×›×”
        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            touchDragElement = e.currentTarget;

            touchStartX = touch.clientX;
            touchStartY = touch.clientY;

            // ×¦×•×¨ ×¢×•×ª×§ ×•×™×–×•××œ×™ ×©×œ ×”××œ×× ×˜
            touchClone = touchDragElement.cloneNode(true);
            touchClone.style.position = 'fixed';
            touchClone.style.pointerEvents = 'none';
            touchClone.style.zIndex = '10000';
            touchClone.style.opacity = '0.8';
            touchClone.style.transform = 'scale(1.1)';
            touchClone.style.left = touch.clientX - touchDragElement.offsetWidth / 2 + 'px';
            touchClone.style.top = touch.clientY - touchDragElement.offsetHeight / 2 + 'px';
            document.body.appendChild(touchClone);

            touchDragElement.style.opacity = '0.3';
        }

        function handleTouchMove(e) {
            if (!touchDragElement || !touchClone) return;
            e.preventDefault();

            const touch = e.touches[0];
            touchClone.style.left = touch.clientX - touchClone.offsetWidth / 2 + 'px';
            touchClone.style.top = touch.clientY - touchClone.offsetHeight / 2 + 'px';

            // ××¦× ××ª ×”××œ×× ×˜ ×©××ª×—×ª ×œ××’×¢
            const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            const dropZone = elemBelow?.closest('#dragLetterTarget, #dragNumberTarget, .sequence-box.empty');

            // ×”×¡×¨ ×”×“×’×©×” ××›×œ ××–×•×¨×™ ×”×–×¨×™×§×”
            document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));

            // ×”×•×¡×£ ×”×“×’×©×” ×œ××–×•×¨ ×”×–×¨×™×§×” ×”× ×•×›×—×™
            if (dropZone) {
                dropZone.classList.add('drag-over');
            }
        }

        function handleTouchEnd(e) {
            if (!touchDragElement || !touchClone) return;
            e.preventDefault();

            const touch = e.changedTouches[0];
            const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            const dropZone = elemBelow?.closest('#dragLetterTarget, #dragNumberTarget, .sequence-box.empty');

            // × ×§×” ××ª ×”×¢×•×ª×§ ×”×•×™×–×•××œ×™
            document.body.removeChild(touchClone);
            touchClone = null;
            touchDragElement.style.opacity = '1';

            // ×”×¡×¨ ×”×“×’×©×”
            document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));

            // ×‘×“×•×§ ×× ×–×¨×§× ×• ×¢×œ ××–×•×¨ ×ª×§×™×Ÿ
            if (dropZone) {
                const dataType = touchDragElement.dataset.letter || touchDragElement.dataset.number;

                if (dropZone.id === 'dragLetterTarget') {
                    checkLetterAnswer(dataType, dropZone);
                } else if (dropZone.id === 'dragNumberTarget') {
                    checkNumberAnswer(parseInt(dataType), dropZone);
                } else if (dropZone.classList.contains('sequence-box')) {
                    checkSequenceAnswer(parseInt(dataType), dropZone);
                }
            }

            touchDragElement = null;
        }

        function checkLetterAnswer(letter, target) {
            if (letter === currentLetterAnswer.letter) {
                target.innerHTML = letter;
                target.classList.add('correct');
                speakText('×›×œ ×”×›×‘×•×“!');
                setTimeout(() => generateLetterQuestion(), 1500);
            } else {
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');
                setTimeout(() => target.classList.remove('incorrect'), 500);
            }
        }

        function checkNumberAnswer(number, target) {
            if (number === currentNumberAnswer) {
                target.innerHTML = number;
                target.classList.add('correct');
                speakText('×›×œ ×”×›×‘×•×“!');
                setTimeout(() => generateNumberQuestion(), 1500);
            } else {
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');
                setTimeout(() => target.classList.remove('incorrect'), 500);
            }
        }

        function checkSequenceAnswer(number, target) {
            if (number === currentNumberSequence.missing) {
                target.textContent = number;
                target.classList.remove('empty');
                target.style.background = '#4CAF50';
                target.style.color = 'white';
                speakText('××¦×•×™×Ÿ!');

                // ×”×¡×ª×¨ ××ª ×”××•×¤×¦×™×”
                const option = document.querySelector(`.sequence-option[data-number="${number}"]`);
                if (option) option.style.opacity = '0';

                setTimeout(() => generateNumberSequence(), 2000);
            } else {
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');
                setTimeout(() => target.classList.remove('incorrect'), 500);
            }
        }

        // Number Games
        function showNumberGame(mode) {
            // ×”×¡×ª×¨ ××ª ×ª×¤×¨×™×˜ ×”××©×—×§×™×
            const numbersPage = document.getElementById('numbers');
            const gamesGrid = numbersPage.querySelector('.games-grid');
            gamesGrid.classList.add('hidden');

            // ×”×¡×ª×¨ ××ª ×›×œ ×”××©×—×§×™×
            document.getElementById('numberLearnMode').style.display = 'none';
            document.getElementById('numberCountMode').style.display = 'none';
            document.getElementById('numberSequenceMode').style.display = 'none';
            document.getElementById('numberWriteMode').style.display = 'none';

            // ×”×¦×’ ××ª ×”××©×—×§ ×©× ×‘×—×¨
            if (mode === 'learn') {
                document.getElementById('numberLearnMode').style.display = 'block';
                initNumbers();
            } else if (mode === 'count') {
                document.getElementById('numberCountMode').style.display = 'block';
                initNumberCountGame();
            } else if (mode === 'sequence') {
                document.getElementById('numberSequenceMode').style.display = 'block';
                initNumberSequenceGame();
            } else if (mode === 'write') {
                document.getElementById('numberWriteMode').style.display = 'block';
                initNumberWriteGame();
            }
        }

        function backToNumberGames() {
            // ×”×¦×’ ××ª ×ª×¤×¨×™×˜ ×”××©×—×§×™×
            const numbersPage = document.getElementById('numbers');
            const gamesGrid = numbersPage.querySelector('.games-grid');
            gamesGrid.classList.remove('hidden');

            // ×”×¡×ª×¨ ××ª ×›×œ ×”××©×—×§×™×
            document.getElementById('numberLearnMode').style.display = 'none';
            document.getElementById('numberCountMode').style.display = 'none';
            document.getElementById('numberSequenceMode').style.display = 'none';
            document.getElementById('numberWriteMode').style.display = 'none';
        }

        let currentNumberAnswer = null;
        const numberEmojis = ['ğŸ', 'ğŸ“', 'â­', 'ğŸ¦‹', 'ğŸŒ¸', 'ğŸˆ', 'ğŸ‹', 'ğŸ”·'];

        function initNumberCountGame() {
            generateNumberQuestion();
        }

        function generateNumberQuestion() {
            // ×‘×—×¨ ××¡×¤×¨ ×¨× ×“×•××œ×™ (1-10)
            currentNumberAnswer = Math.floor(Math.random() * 10) + 1;

            // ×‘×—×¨ ××™××•×’'×™ ×¨× ×“×•××œ×™
            const emoji = numberEmojis[Math.floor(Math.random() * numberEmojis.length)];

            // ×”×¦×’ ××ª ×”××•×‘×™×™×§×˜×™×
            let objectsHtml = '';
            for (let i = 0; i < currentNumberAnswer; i++) {
                objectsHtml += emoji + ' ';
            }
            document.getElementById('countObjectsDisplay').innerHTML = objectsHtml;

            // × ×§×” ××ª ××–×•×¨ ×”×’×¨×™×¨×”
            const target = document.getElementById('dragNumberTarget');
            target.innerHTML = '';
            target.className = 'drop-zone';
            target.style.background = '#f0f4ff';
            target.style.borderColor = '#667eea';

            // ×¦×•×¨ 4 ××¡×¤×¨×™× ××§×¨××™×™× (×›×•×œ×œ ×”×ª×©×•×‘×” ×”× ×›×•× ×”)
            const options = [currentNumberAnswer];
            while (options.length < 4) {
                const randomNum = Math.floor(Math.random() * 10) + 1;
                if (!options.includes(randomNum)) {
                    options.push(randomNum);
                }
            }

            // ×¢×¨×‘×‘ ××ª ×”××¤×©×¨×•×™×•×ª
            options.sort(() => Math.random() - 0.5);

            // ×”×¦×’ ××ª ×”××¡×¤×¨×™×
            const optionsContainer = document.getElementById('dragNumberOptions');
            optionsContainer.innerHTML = '';

            options.forEach(num => {
                const numberDiv = document.createElement('div');
                numberDiv.className = 'draggable-item';
                numberDiv.textContent = num;
                numberDiv.draggable = true;
                numberDiv.dataset.number = num;

                // Desktop drag events
                numberDiv.addEventListener('dragstart', handleNumberDragStart);
                numberDiv.addEventListener('dragend', handleDragEnd);

                // Mobile touch events - ×’×¨×™×¨×” ××™×™×“×™×ª
                numberDiv.addEventListener('touchstart', handleTouchStart, { passive: false });
                numberDiv.addEventListener('touchmove', handleTouchMove, { passive: false });
                numberDiv.addEventListener('touchend', handleTouchEnd, { passive: false });

                optionsContainer.appendChild(numberDiv);
            });

            // ×”×•×¡×£ event listeners ×œ××–×•×¨ ×”×’×¨×™×¨×”
            target.addEventListener('dragover', handleDragOver);
            target.addEventListener('drop', handleNumberDrop);
            target.addEventListener('dragleave', handleDragLeave);
        }

        function handleNumberDragStart(e) {
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', e.currentTarget.dataset.number);
        }

        function handleNumberDrop(e) {
            e.preventDefault();
            const target = e.currentTarget;
            target.classList.remove('drag-over');

            const droppedNumber = parseInt(e.dataTransfer.getData('text/plain'));

            if (droppedNumber === currentNumberAnswer) {
                // ×ª×©×•×‘×” × ×›×•× ×”!
                target.innerHTML = droppedNumber;
                target.classList.add('correct');
                speakText('×›×œ ×”×›×‘×•×“!');

                setTimeout(() => {
                    generateNumberQuestion();
                }, 1500);
            } else {
                // ×ª×©×•×‘×” ×©×’×•×™×”
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');

                setTimeout(() => {
                    target.classList.remove('incorrect');
                }, 500);
            }
        }

        // Number Sequence Game
        let currentNumberSequence = null;
        let missingNumberIndex = null;

        function initNumberSequenceGame() {
            generateNumberSequence();
        }

        function generateNumberSequence() {
            // ×‘×—×¨ ××¡×¤×¨ ×”×ª×—×œ×” ×¨× ×“×•××œ×™ (1-7)
            const startNum = Math.floor(Math.random() * 7) + 1;

            // ×¦×•×¨ ×¨×¦×£ ×©×œ 4 ××¡×¤×¨×™×
            const sequence = [startNum, startNum + 1, startNum + 2, startNum + 3];

            // ×‘×—×¨ ××™×–×” ××¡×¤×¨ ×™×”×™×” ×—×¡×¨ (×œ× ×”×¨××©×•×Ÿ ×•×œ× ×”××—×¨×•×Ÿ)
            missingNumberIndex = Math.floor(Math.random() * 2) + 1; // 1 ××• 2
            currentNumberSequence = {
                sequence: sequence,
                missing: sequence[missingNumberIndex]
            };

            // ×”×¦×’ ××ª ×”×¨×¦×£
            const display = document.getElementById('sequenceDisplay');
            display.innerHTML = '';

            sequence.forEach((num, index) => {
                const box = document.createElement('div');
                box.className = 'sequence-box' + (index === missingNumberIndex ? ' empty drop-zone' : '');
                box.textContent = index === missingNumberIndex ? '' : num;

                // ×”×•×¡×£ event listeners ×œ×ª×™×‘×” ×”×¨×™×§×”
                if (index === missingNumberIndex) {
                    box.addEventListener('dragover', handleSequenceDragOver);
                    box.addEventListener('drop', handleNumberSequenceDrop);
                    box.addEventListener('dragleave', handleSequenceDragLeave);
                }

                display.appendChild(box);
            });

            // ×”×¦×’ ××¤×©×¨×•×™×•×ª ×ª×©×•×‘×”
            const options = [];
            options.push(currentNumberSequence.missing);

            // ×”×•×¡×£ 2 ×ª×©×•×‘×•×ª ×©×’×•×™×•×ª
            while (options.length < 3) {
                const wrongNum = Math.floor(Math.random() * 10) + 1;
                if (!options.includes(wrongNum) && !sequence.includes(wrongNum)) {
                    options.push(wrongNum);
                }
            }

            options.sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('sequenceOptions');
            optionsContainer.innerHTML = '';

            options.forEach(num => {
                const option = document.createElement('div');
                option.className = 'sequence-option';
                option.textContent = num;
                option.draggable = true;
                option.dataset.number = num;

                // Desktop drag events
                option.addEventListener('dragstart', handleSequenceDragStart);
                option.addEventListener('dragend', handleDragEnd);

                // Mobile touch events - ×’×¨×™×¨×” ××™×™×“×™×ª
                option.addEventListener('touchstart', handleTouchStart, { passive: false });
                option.addEventListener('touchmove', handleTouchMove, { passive: false });
                option.addEventListener('touchend', handleTouchEnd, { passive: false });

                optionsContainer.appendChild(option);
            });
        }

        function handleSequenceDragStart(e) {
            e.currentTarget.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', e.currentTarget.dataset.number || e.currentTarget.dataset.letter);
        }

        function handleSequenceDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function handleSequenceDragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function handleNumberSequenceDrop(e) {
            e.preventDefault();
            const target = e.currentTarget;
            target.classList.remove('drag-over');

            const droppedNumber = parseInt(e.dataTransfer.getData('text/plain'));

            if (droppedNumber === currentNumberSequence.missing) {
                // ×ª×©×•×‘×” × ×›×•× ×”!
                target.textContent = droppedNumber;
                target.classList.remove('empty');
                target.style.background = '#4CAF50';
                target.style.color = 'white';
                speakText('××¦×•×™×Ÿ!');

                // ×”×¡×ª×¨ ××ª ×”××¤×©×¨×•×ª ×©× ×’×¨×¨×”
                const draggedElement = document.querySelector('.sequence-option.dragging');
                if (draggedElement) {
                    draggedElement.style.opacity = '0';
                }

                setTimeout(() => {
                    generateNumberSequence();
                }, 2000);
            } else {
                // ×ª×©×•×‘×” ×©×’×•×™×”
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');

                setTimeout(() => {
                    target.classList.remove('incorrect');
                }, 800);
            }
        }

        // Letter Sequence Game
        let currentLetterSequence = null;
        let missingLetterIndex = null;

        const allHebrewLetters = [
            '×', '×‘', '×’', '×“', '×”', '×•', '×–', '×—', '×˜', '×™',
            '×›', '×œ', '×', '× ', '×¡', '×¢', '×¤', '×¦', '×§', '×¨', '×©', '×ª'
        ];

        function initLetterSequenceGame() {
            generateLetterSequence();
        }

        function generateLetterSequence() {
            // ×‘×—×¨ ××•×ª ×”×ª×—×œ×” ×¨× ×“×•××œ×™×ª (×œ× ××”××—×¨×•× ×•×ª)
            const startIndex = Math.floor(Math.random() * (allHebrewLetters.length - 4));

            // ×¦×•×¨ ×¨×¦×£ ×©×œ 4 ××•×ª×™×•×ª
            const sequence = [
                allHebrewLetters[startIndex],
                allHebrewLetters[startIndex + 1],
                allHebrewLetters[startIndex + 2],
                allHebrewLetters[startIndex + 3]
            ];

            // ×‘×—×¨ ××™×–×• ××•×ª ×ª×”×™×” ×—×¡×¨×” (×œ× ×”×¨××©×•× ×” ×•×œ× ×”××—×¨×•× ×”)
            missingLetterIndex = Math.floor(Math.random() * 2) + 1; // 1 ××• 2
            currentLetterSequence = {
                sequence: sequence,
                missing: sequence[missingLetterIndex]
            };

            // ×”×¦×’ ××ª ×”×¨×¦×£
            const display = document.getElementById('letterSequenceDisplay');
            display.innerHTML = '';

            sequence.forEach((letter, index) => {
                const box = document.createElement('div');
                box.className = 'sequence-box' + (index === missingLetterIndex ? ' empty drop-zone' : '');
                box.textContent = index === missingLetterIndex ? '' : letter;

                // ×”×•×¡×£ event listeners ×œ×ª×™×‘×” ×”×¨×™×§×”
                if (index === missingLetterIndex) {
                    box.addEventListener('dragover', handleSequenceDragOver);
                    box.addEventListener('drop', handleLetterSequenceDrop);
                    box.addEventListener('dragleave', handleSequenceDragLeave);
                }

                display.appendChild(box);
            });

            // ×”×¦×’ ××¤×©×¨×•×™×•×ª ×ª×©×•×‘×”
            const options = [];
            options.push(currentLetterSequence.missing);

            // ×”×•×¡×£ 2 ×ª×©×•×‘×•×ª ×©×’×•×™×•×ª
            while (options.length < 3) {
                const randomLetter = allHebrewLetters[Math.floor(Math.random() * allHebrewLetters.length)];
                if (!options.includes(randomLetter) && !sequence.includes(randomLetter)) {
                    options.push(randomLetter);
                }
            }

            options.sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('letterSequenceOptions');
            optionsContainer.innerHTML = '';

            options.forEach(letter => {
                const option = document.createElement('div');
                option.className = 'sequence-option';
                option.textContent = letter;
                option.draggable = true;
                option.dataset.letter = letter;

                option.addEventListener('dragstart', handleSequenceDragStart);
                option.addEventListener('dragend', handleDragEnd);

                optionsContainer.appendChild(option);
            });
        }

        function handleLetterSequenceDrop(e) {
            e.preventDefault();
            const target = e.currentTarget;
            target.classList.remove('drag-over');

            const droppedLetter = e.dataTransfer.getData('text/plain');

            if (droppedLetter === currentLetterSequence.missing) {
                // ×ª×©×•×‘×” × ×›×•× ×”!
                target.textContent = droppedLetter;
                target.classList.remove('empty');
                target.style.background = '#4CAF50';
                target.style.color = 'white';
                speakText('××¢×•×œ×”!');

                // ×”×¡×ª×¨ ××ª ×”××¤×©×¨×•×ª ×©× ×’×¨×¨×”
                const draggedElement = document.querySelector('.sequence-option.dragging');
                if (draggedElement) {
                    draggedElement.style.opacity = '0';
                }

                setTimeout(() => {
                    generateLetterSequence();
                }, 2000);
            } else {
                // ×ª×©×•×‘×” ×©×’×•×™×”
                target.classList.add('incorrect');
                speakText('× ×¡×• ×©×•×‘');

                setTimeout(() => {
                    target.classList.remove('incorrect');
                }, 800);
            }
        }

        // Letter Writing Game
        let writeCanvas, writeCtx, isWriting = false;
        let currentLetterIndex = 0;
        const writingLetters = [
            '×', '×‘', '×’', '×“', '×”', '×•', '×–', '×—', '×˜', '×™',
            '×›', '×œ', '×', '× ', '×¡', '×¢', '×¤', '×¦', '×§', '×¨', '×©', '×ª'
        ];

        function initLetterWriteGame() {
            writeCanvas = document.getElementById('letterWriteCanvas');
            writeCtx = writeCanvas.getContext('2d');

            // Mouse events
            writeCanvas.addEventListener('mousedown', startWriting);
            writeCanvas.addEventListener('mousemove', writeOnCanvas);
            writeCanvas.addEventListener('mouseup', stopWriting);
            writeCanvas.addEventListener('mouseout', stopWriting);

            // Touch events for mobile
            writeCanvas.addEventListener('touchstart', handleWriteTouch);
            writeCanvas.addEventListener('touchmove', handleWriteTouch);
            writeCanvas.addEventListener('touchend', stopWriting);

            // Create navigation buttons for all letters
            createLetterNavigation();

            // Display first letter
            displayLetterTemplate(currentLetterIndex);
        }

        function createLetterNavigation() {
            const nav = document.getElementById('letterNavigation');
            nav.innerHTML = '';

            writingLetters.forEach((letter, index) => {
                const btn = document.createElement('button');
                btn.className = 'letter-nav-btn';
                btn.textContent = letter;
                btn.style.cssText = 'background: linear-gradient(135deg, #fdeb71 0%, #f8d800 100%); border: none; border-radius: 10px; padding: 10px 15px; font-size: 1.5em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);';
                btn.onclick = () => {
                    currentLetterIndex = index;
                    displayLetterTemplate(index);
                };
                btn.onmouseover = function() {
                    this.style.transform = 'scale(1.1)';
                    this.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.2)';
                };
                btn.onmouseout = function() {
                    this.style.transform = 'scale(1)';
                    this.style.boxShadow = '0 3px 10px rgba(0, 0, 0, 0.1)';
                };
                nav.appendChild(btn);
            });
        }

        function displayLetterTemplate(index) {
            const letter = writingLetters[index];
            document.getElementById('currentWriteLetter').textContent = letter;
            speakText(letter);

            // Clear canvas
            writeCtx.fillStyle = 'white';
            writeCtx.fillRect(0, 0, writeCanvas.width, writeCanvas.height);

            // Draw dotted letter outline as template
            writeCtx.font = 'bold 400px Arial';
            writeCtx.textAlign = 'center';
            writeCtx.textBaseline = 'middle';
            writeCtx.lineWidth = 3;
            writeCtx.strokeStyle = '#ccc';
            writeCtx.setLineDash([10, 10]);
            writeCtx.strokeText(letter, writeCanvas.width / 2, writeCanvas.height / 2);
            writeCtx.setLineDash([]);
        }

        function getCanvasCoordinates(canvas, clientX, clientY) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;

            return {
                x: (clientX - rect.left) * scaleX,
                y: (clientY - rect.top) * scaleY
            };
        }

        function startWriting(e) {
            isWriting = true;
            const coords = getCanvasCoordinates(writeCanvas, e.clientX, e.clientY);

            writeCtx.beginPath();
            writeCtx.moveTo(coords.x, coords.y);
        }

        function writeOnCanvas(e) {
            if (!isWriting) return;

            const coords = getCanvasCoordinates(writeCanvas, e.clientX, e.clientY);

            writeCtx.strokeStyle = '#667eea';
            writeCtx.lineWidth = 8;
            writeCtx.lineCap = 'round';
            writeCtx.lineJoin = 'round';
            writeCtx.lineTo(coords.x, coords.y);
            writeCtx.stroke();
        }

        function stopWriting() {
            isWriting = false;
        }

        function handleWriteTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];

            if (e.type === 'touchstart') {
                isWriting = true;
                const coords = getCanvasCoordinates(writeCanvas, touch.clientX, touch.clientY);
                writeCtx.beginPath();
                writeCtx.moveTo(coords.x, coords.y);
            } else if (e.type === 'touchmove' && isWriting) {
                const coords = getCanvasCoordinates(writeCanvas, touch.clientX, touch.clientY);
                writeCtx.strokeStyle = '#667eea';
                writeCtx.lineWidth = 8;
                writeCtx.lineCap = 'round';
                writeCtx.lineJoin = 'round';
                writeCtx.lineTo(coords.x, coords.y);
                writeCtx.stroke();
            }
        }

        function clearLetterCanvas() {
            displayLetterTemplate(currentLetterIndex);
        }

        function nextLetter() {
            currentLetterIndex = (currentLetterIndex + 1) % writingLetters.length;
            displayLetterTemplate(currentLetterIndex);
        }

        function previousLetter() {
            currentLetterIndex = (currentLetterIndex - 1 + writingLetters.length) % writingLetters.length;
            displayLetterTemplate(currentLetterIndex);
        }

        // Number Writing Game
        let numberWriteCanvas, numberWriteCtx, isNumberWriting = false;
        let currentNumberWriteIndex = 0;
        const writingNumbers = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10'];
        const numberWords = ['××¤×¡', '××—×ª', '×©×ª×™×™×', '×©×œ×•×©', '××¨×‘×¢', '×—××©', '×©×©', '×©×‘×¢', '×©××•× ×”', '×ª×©×¢', '×¢×©×¨'];

        function initNumberWriteGame() {
            numberWriteCanvas = document.getElementById('numberWriteCanvas');
            numberWriteCtx = numberWriteCanvas.getContext('2d');

            // Mouse events
            numberWriteCanvas.addEventListener('mousedown', startNumberWriting);
            numberWriteCanvas.addEventListener('mousemove', writeOnNumberCanvas);
            numberWriteCanvas.addEventListener('mouseup', stopNumberWriting);
            numberWriteCanvas.addEventListener('mouseout', stopNumberWriting);

            // Touch events for mobile
            numberWriteCanvas.addEventListener('touchstart', handleNumberWriteTouch);
            numberWriteCanvas.addEventListener('touchmove', handleNumberWriteTouch);
            numberWriteCanvas.addEventListener('touchend', stopNumberWriting);

            // Create navigation buttons for all numbers
            createNumberNavigation();

            // Display first number
            displayNumberTemplate(currentNumberWriteIndex);
        }

        function createNumberNavigation() {
            const nav = document.getElementById('numberNavigation');
            nav.innerHTML = '';

            writingNumbers.forEach((number, index) => {
                const btn = document.createElement('button');
                btn.className = 'number-nav-btn';
                btn.textContent = number;
                btn.style.cssText = 'background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border: none; border-radius: 10px; padding: 10px 15px; font-size: 1.5em; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1); min-width: 50px;';
                btn.onclick = () => {
                    currentNumberWriteIndex = index;
                    displayNumberTemplate(index);
                };
                btn.onmouseover = function() {
                    this.style.transform = 'scale(1.1)';
                    this.style.boxShadow = '0 5px 15px rgba(0, 0, 0, 0.2)';
                };
                btn.onmouseout = function() {
                    this.style.transform = 'scale(1)';
                    this.style.boxShadow = '0 3px 10px rgba(0, 0, 0, 0.1)';
                };
                nav.appendChild(btn);
            });
        }

        function displayNumberTemplate(index) {
            const number = writingNumbers[index];
            const numberWord = numberWords[index];
            document.getElementById('currentWriteNumber').textContent = `${number} - ${numberWord}`;
            speakText(numberWord);

            // Clear canvas
            numberWriteCtx.fillStyle = 'white';
            numberWriteCtx.fillRect(0, 0, numberWriteCanvas.width, numberWriteCanvas.height);

            // Draw dotted number outline as template
            numberWriteCtx.font = 'bold 400px Arial';
            numberWriteCtx.textAlign = 'center';
            numberWriteCtx.textBaseline = 'middle';
            numberWriteCtx.lineWidth = 3;
            numberWriteCtx.strokeStyle = '#ccc';
            numberWriteCtx.setLineDash([10, 10]);
            numberWriteCtx.strokeText(number, numberWriteCanvas.width / 2, numberWriteCanvas.height / 2);
            numberWriteCtx.setLineDash([]);
        }

        function startNumberWriting(e) {
            isNumberWriting = true;
            const coords = getCanvasCoordinates(numberWriteCanvas, e.clientX, e.clientY);

            numberWriteCtx.beginPath();
            numberWriteCtx.moveTo(coords.x, coords.y);
        }

        function writeOnNumberCanvas(e) {
            if (!isNumberWriting) return;

            const coords = getCanvasCoordinates(numberWriteCanvas, e.clientX, e.clientY);

            numberWriteCtx.strokeStyle = '#667eea';
            numberWriteCtx.lineWidth = 8;
            numberWriteCtx.lineCap = 'round';
            numberWriteCtx.lineJoin = 'round';
            numberWriteCtx.lineTo(coords.x, coords.y);
            numberWriteCtx.stroke();
        }

        function stopNumberWriting() {
            isNumberWriting = false;
        }

        function handleNumberWriteTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];

            if (e.type === 'touchstart') {
                isNumberWriting = true;
                const coords = getCanvasCoordinates(numberWriteCanvas, touch.clientX, touch.clientY);
                numberWriteCtx.beginPath();
                numberWriteCtx.moveTo(coords.x, coords.y);
            } else if (e.type === 'touchmove' && isNumberWriting) {
                const coords = getCanvasCoordinates(numberWriteCanvas, touch.clientX, touch.clientY);
                numberWriteCtx.strokeStyle = '#667eea';
                numberWriteCtx.lineWidth = 8;
                numberWriteCtx.lineCap = 'round';
                numberWriteCtx.lineJoin = 'round';
                numberWriteCtx.lineTo(coords.x, coords.y);
                numberWriteCtx.stroke();
            }
        }

        function clearNumberCanvas() {
            displayNumberTemplate(currentNumberWriteIndex);
        }

        function nextNumber() {
            currentNumberWriteIndex = (currentNumberWriteIndex + 1) % writingNumbers.length;
            displayNumberTemplate(currentNumberWriteIndex);
        }

        function previousNumber() {
            currentNumberWriteIndex = (currentNumberWriteIndex - 1 + writingNumbers.length) % writingNumbers.length;
            displayNumberTemplate(currentNumberWriteIndex);
        }

        // Printables Page Navigation
        let currentSheetIndex = 1;
        const totalSheets = 4;

        function updateSheetDisplay() {
            // Hide all sheets
            for (let i = 1; i <= totalSheets; i++) {
                const sheet = document.getElementById('sheet' + i);
                if (sheet) {
                    sheet.style.display = 'none';
                }
            }

            // Show current sheet
            const currentSheet = document.getElementById('sheet' + currentSheetIndex);
            if (currentSheet) {
                currentSheet.style.display = 'block';
            }

            // Update indicator
            const indicator = document.getElementById('sheetIndicator');
            if (indicator) {
                indicator.textContent = `×“×£ ${currentSheetIndex} ××ª×•×š ${totalSheets}`;
            }
        }

        function nextSheet() {
            currentSheetIndex = (currentSheetIndex % totalSheets) + 1;
            updateSheetDisplay();
        }

        function previousSheet() {
            currentSheetIndex = currentSheetIndex - 1;
            if (currentSheetIndex < 1) {
                currentSheetIndex = totalSheets;
            }
            updateSheetDisplay();
        }

        function printCurrentSheet() {
            // Create a print-friendly version
            const sheet = document.getElementById('sheet' + currentSheetIndex);
            if (!sheet) return;

            // Open print dialog
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html lang="he" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>×“×£ ×¤×¢×™×œ×•×ª ${currentSheetIndex}</title>
                    <style>
                        @media print {
                            @page {
                                size: A4;
                                margin: 1cm;
                            }
                        }
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            margin: 0;
                            padding: 20px;
                        }
                    </style>
                </head>
                <body>
                    ${sheet.innerHTML}
                </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => {
                printWindow.print();
            }, 250);
        }

        // Initialize sheet display when entering printables page
        window.addEventListener('DOMContentLoaded', () => {
            updateSheetDisplay();
        });
    </script>
</body>
</html>
